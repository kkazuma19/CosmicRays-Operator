Using device: cuda
Train input shape: (4017, 12)
Validation input shape: (4018, 12)
Test input shape: (365, 12)
Training with window_size=7
Check the shapes of the generated sequences
-----------------------------------------
Train input shape: torch.Size([4011, 7, 12])
Train target shape: torch.Size([4011, 65341, 1])
Validation input shape: torch.Size([4012, 7, 12])
Validation target shape: torch.Size([4012, 65341, 1])
Test input shape: torch.Size([359, 7, 12])
Test target shape: torch.Size([359, 65341, 1])
-----------------------------------------
Create DataLoaders for training and validation sets
-----------------------------------------
Batch size: 16
Set the hyperparameters
-----------------------------------------
multi_branch/gru_window_7.pth
Number of epochs: 1000
Learning rate: 0.001
Patience: 10
Loss function: MSELoss()
-----------------------------------------

--- Repetition 1/5 ---
Epoch 1: Train Loss = 37.927865, Val Loss = 0.003202
Epoch 2: Train Loss = 0.003437, Val Loss = 0.001595
Epoch 3: Train Loss = 0.002075, Val Loss = 0.001166
Epoch 4: Train Loss = 0.001929, Val Loss = 0.001687
Epoch 5: Train Loss = 0.002052, Val Loss = 0.001483
Epoch 6: Train Loss = 0.001882, Val Loss = 0.002754
Epoch 7: Train Loss = 0.001797, Val Loss = 0.001541
Epoch 8: Train Loss = 0.001868, Val Loss = 0.001849
Epoch 9: Train Loss = 0.001709, Val Loss = 0.001512
Epoch 10: Train Loss = 0.001819, Val Loss = 0.001201
Epoch 11: Train Loss = 0.001691, Val Loss = 0.001275
Epoch 12: Train Loss = 0.001675, Val Loss = 0.001757
Epoch 13: Train Loss = 0.001733, Val Loss = 0.001138
Epoch 14: Train Loss = 0.001861, Val Loss = 0.000801
Epoch 15: Train Loss = 0.001739, Val Loss = 0.000894
Epoch 16: Train Loss = 0.002013, Val Loss = 0.000814
Epoch 17: Train Loss = 0.001995, Val Loss = 0.001517
Epoch 18: Train Loss = 0.001930, Val Loss = 0.000628
Epoch 19: Train Loss = 0.001783, Val Loss = 0.000524
Epoch 20: Train Loss = 0.001645, Val Loss = 0.001069
Epoch 21: Train Loss = 0.001909, Val Loss = 0.003099
Epoch 22: Train Loss = 0.002379, Val Loss = 0.000863
Epoch 23: Train Loss = 0.001523, Val Loss = 0.002796
Epoch 24: Train Loss = 0.001519, Val Loss = 0.000603
Epoch 25: Train Loss = 0.001723, Val Loss = 0.000339
Epoch 26: Train Loss = 0.001274, Val Loss = 0.000804
Epoch 27: Train Loss = 0.001575, Val Loss = 0.000915
Epoch 28: Train Loss = 0.001687, Val Loss = 0.000746
Epoch 29: Train Loss = 0.002195, Val Loss = 0.000425
Epoch 30: Train Loss = 0.001507, Val Loss = 0.003181
Epoch 31: Train Loss = 0.002824, Val Loss = 0.000818
Epoch 32: Train Loss = 0.002202, Val Loss = 0.000319
Epoch 33: Train Loss = 0.002073, Val Loss = 0.000455
Epoch 34: Train Loss = 0.002359, Val Loss = 0.000557
Epoch 35: Train Loss = 99481972.649011, Val Loss = 2.356910
Epoch 36: Train Loss = 2.278427, Val Loss = 1.975188
Epoch 37: Train Loss = 1.859837, Val Loss = 1.078632
Epoch 38: Train Loss = 1.636098, Val Loss = 0.652260
Epoch 39: Train Loss = 1.529727, Val Loss = 0.844740
Epoch 40: Train Loss = 1.299171, Val Loss = 0.317602
Epoch 41: Train Loss = 1.247312, Val Loss = 0.642584
Epoch 42: Train Loss = 0.988556, Val Loss = 0.184534
Early stopping at epoch 42
Repetition 1 finished: Total Time = 1423.16s, Time/sample = 0.008448s

--- Repetition 2/5 ---
Epoch 1: Train Loss = 53656.176024, Val Loss = 0.001435
Epoch 2: Train Loss = 0.002558, Val Loss = 0.001237
Epoch 3: Train Loss = 0.002163, Val Loss = 0.005756
Epoch 4: Train Loss = 0.002409, Val Loss = 0.001658
Epoch 5: Train Loss = 0.002958, Val Loss = 0.000719
Epoch 6: Train Loss = 0.002667, Val Loss = 0.001697
Epoch 7: Train Loss = 0.003817, Val Loss = 0.000437
Epoch 8: Train Loss = 0.003010, Val Loss = 0.002823
Epoch 9: Train Loss = 0.002382, Val Loss = 0.002154
Epoch 10: Train Loss = 0.003449, Val Loss = 0.001670
Epoch 11: Train Loss = 0.002516, Val Loss = 0.001032
Epoch 12: Train Loss = 0.002443, Val Loss = 0.007736
Epoch 13: Train Loss = 0.002997, Val Loss = 0.008238
Epoch 14: Train Loss = 0.003008, Val Loss = 0.000563
Epoch 15: Train Loss = 0.003795, Val Loss = 0.007528
Epoch 16: Train Loss = 0.002228, Val Loss = 0.004196
Epoch 17: Train Loss = 0.002912, Val Loss = 0.000403
Epoch 18: Train Loss = 0.002991, Val Loss = 0.003012
Epoch 19: Train Loss = 0.003545, Val Loss = 0.002037
Epoch 20: Train Loss = 0.003933, Val Loss = 0.001014
Epoch 21: Train Loss = 0.002271, Val Loss = 0.000706
Epoch 22: Train Loss = 0.003677, Val Loss = 0.004986
Epoch 23: Train Loss = 0.002568, Val Loss = 0.000919
Epoch 24: Train Loss = 0.003210, Val Loss = 0.001515
Epoch 25: Train Loss = 0.002570, Val Loss = 0.005608
Epoch 26: Train Loss = 0.003380, Val Loss = 0.000494
Epoch 27: Train Loss = 0.003449, Val Loss = 0.000415
Early stopping at epoch 27
Repetition 2 finished: Total Time = 911.62s, Time/sample = 0.008418s

--- Repetition 3/5 ---
Epoch 1: Train Loss = 21731.461704, Val Loss = 0.009250
Epoch 2: Train Loss = 0.002679, Val Loss = 0.003333
Epoch 3: Train Loss = 0.002250, Val Loss = 0.003030
Epoch 4: Train Loss = 0.002620, Val Loss = 0.002725
Epoch 5: Train Loss = 0.003147, Val Loss = 0.000818
Epoch 6: Train Loss = 0.002563, Val Loss = 0.001169
Epoch 7: Train Loss = 0.004709, Val Loss = 0.000485
Epoch 8: Train Loss = 0.002704, Val Loss = 0.001278
Epoch 9: Train Loss = 0.002227, Val Loss = 0.000416
Epoch 10: Train Loss = 0.003031, Val Loss = 0.001648
Epoch 11: Train Loss = 0.004159, Val Loss = 0.003181
Epoch 12: Train Loss = 0.002758, Val Loss = 0.000402
Epoch 13: Train Loss = 0.004302, Val Loss = 0.000398
Epoch 14: Train Loss = 0.002266, Val Loss = 0.000828
Epoch 15: Train Loss = 0.002999, Val Loss = 0.000704
Epoch 16: Train Loss = 0.003622, Val Loss = 0.005505
Epoch 17: Train Loss = 0.003121, Val Loss = 0.003409
Epoch 18: Train Loss = 0.004027, Val Loss = 0.000428
Epoch 19: Train Loss = 0.002320, Val Loss = 0.000637
Epoch 20: Train Loss = 0.002663, Val Loss = 0.000575
Epoch 21: Train Loss = 0.004069, Val Loss = 0.000379
Epoch 22: Train Loss = 0.002763, Val Loss = 0.000379
Epoch 23: Train Loss = 0.002617, Val Loss = 0.000890
Epoch 24: Train Loss = 0.003861, Val Loss = 0.002782
Epoch 25: Train Loss = 0.003029, Val Loss = 0.005583
Epoch 26: Train Loss = 0.003196, Val Loss = 0.000606
Epoch 27: Train Loss = 0.002434, Val Loss = 0.000357
Epoch 28: Train Loss = 0.003133, Val Loss = 0.000607
Epoch 29: Train Loss = 0.003234, Val Loss = 0.007791
Epoch 30: Train Loss = 0.004200, Val Loss = 0.001626
Epoch 31: Train Loss = 0.002405, Val Loss = 0.000614
Epoch 32: Train Loss = 0.002505, Val Loss = 0.000594
Epoch 33: Train Loss = 0.002931, Val Loss = 0.001982
Epoch 34: Train Loss = 0.003034, Val Loss = 0.000403
Epoch 35: Train Loss = 0.003678, Val Loss = 0.008563
Epoch 36: Train Loss = 0.002890, Val Loss = 0.009757
Epoch 37: Train Loss = 0.002738, Val Loss = 0.002538
Early stopping at epoch 37
Repetition 3 finished: Total Time = 1177.19s, Time/sample = 0.007932s

--- Repetition 4/5 ---
Epoch 1: Train Loss = 1562.133165, Val Loss = 0.003575
Epoch 2: Train Loss = 0.003325, Val Loss = 0.003412
Epoch 3: Train Loss = 0.002664, Val Loss = 0.001486
Epoch 4: Train Loss = 0.002984, Val Loss = 0.001288
Epoch 5: Train Loss = 0.002584, Val Loss = 0.004110
Epoch 6: Train Loss = 0.002093, Val Loss = 0.000828
Epoch 7: Train Loss = 0.001926, Val Loss = 0.001423
Epoch 8: Train Loss = 0.001735, Val Loss = 0.001144
Epoch 9: Train Loss = 0.002097, Val Loss = 0.000722
Epoch 10: Train Loss = 0.002180, Val Loss = 0.002270
Epoch 11: Train Loss = 0.001976, Val Loss = 0.002429
Epoch 12: Train Loss = 0.001488, Val Loss = 0.001902
Epoch 13: Train Loss = 0.692461, Val Loss = 0.124932
Epoch 14: Train Loss = 623551.316725, Val Loss = 0.356053
Epoch 15: Train Loss = 0.294604, Val Loss = 0.092332
Epoch 16: Train Loss = 0.124947, Val Loss = 0.123530
Epoch 17: Train Loss = 0.133004, Val Loss = 0.056308
Epoch 18: Train Loss = 0.074285, Val Loss = 0.070494
Epoch 19: Train Loss = 0.055620, Val Loss = 0.044400
Early stopping at epoch 19
Repetition 4 finished: Total Time = 507.94s, Time/sample = 0.006665s

--- Repetition 5/5 ---
Epoch 1: Train Loss = 43.349252, Val Loss = 0.002360
Epoch 2: Train Loss = 0.002779, Val Loss = 0.001711
Epoch 3: Train Loss = 0.002311, Val Loss = 0.001727
Epoch 4: Train Loss = 0.001927, Val Loss = 0.001243
Epoch 5: Train Loss = 0.002408, Val Loss = 0.000490
Epoch 6: Train Loss = 0.002372, Val Loss = 0.001205
Epoch 7: Train Loss = 0.002636, Val Loss = 0.000407
Epoch 8: Train Loss = 0.003118, Val Loss = 0.003504
Epoch 9: Train Loss = 0.002797, Val Loss = 0.000380
Epoch 10: Train Loss = 0.002334, Val Loss = 0.000810
Epoch 11: Train Loss = 0.002367, Val Loss = 0.006016
Epoch 12: Train Loss = 0.002347, Val Loss = 0.002250
Epoch 13: Train Loss = 0.001844, Val Loss = 0.000438
Epoch 14: Train Loss = 5853.752398, Val Loss = 0.367917
Epoch 15: Train Loss = 0.102463, Val Loss = 0.004252
Epoch 16: Train Loss = 0.006885, Val Loss = 0.003238
Epoch 17: Train Loss = 0.005386, Val Loss = 0.001467
Epoch 18: Train Loss = 0.003870, Val Loss = 0.002684
Epoch 19: Train Loss = 0.003804, Val Loss = 0.002495
Early stopping at epoch 19
Repetition 5 finished: Total Time = 505.91s, Time/sample = 0.006638s

====== MIONet Training Time Benchmark ======
Run 1: Total = 1423.16s, Per Sample = 0.008448s
Run 2: Total = 911.62s, Per Sample = 0.008418s
Run 3: Total = 1177.19s, Per Sample = 0.007932s
Run 4: Total = 507.94s, Per Sample = 0.006665s
Run 5: Total = 505.91s, Per Sample = 0.006638s

Average Total Time: 905.16s
Average Time per Sample: 0.007620s
