Using device: cuda
Train input shape: (4017, 12)
Validation input shape: (4018, 12)
Test input shape: (365, 12)
Training with window_size=7
Check the shapes of the generated sequences
-----------------------------------------
Train input shape: torch.Size([4011, 7, 12])
Train target shape: torch.Size([4011, 65341, 1])
Validation input shape: torch.Size([4012, 7, 12])
Validation target shape: torch.Size([4012, 65341, 1])
Test input shape: torch.Size([359, 7, 12])
Test target shape: torch.Size([359, 65341, 1])
-----------------------------------------
Create DataLoaders for training and validation sets
-----------------------------------------
Batch size: 16
Set the hyperparameters
-----------------------------------------
multi_branch/gru_window_7.pth
Number of epochs: 1000
Learning rate: 0.001
Patience: 10
Loss function: MSELoss()
-----------------------------------------
Epoch 1/1000, Train Loss: 0.181959, Val Loss: 0.001870
Epoch 2/1000, Train Loss: 0.002687, Val Loss: 0.000821
Epoch 3/1000, Train Loss: 0.003066, Val Loss: 0.003154
Epoch 4/1000, Train Loss: 0.002648, Val Loss: 0.011037
Epoch 5/1000, Train Loss: 0.002929, Val Loss: 0.003062
Epoch 6/1000, Train Loss: 0.002563, Val Loss: 0.001495
Epoch 7/1000, Train Loss: 0.003999, Val Loss: 0.003465
Epoch 8/1000, Train Loss: 0.003722, Val Loss: 0.000304
Epoch 9/1000, Train Loss: 0.003343, Val Loss: 0.002298
Epoch 10/1000, Train Loss: 0.003837, Val Loss: 0.000542
Epoch 11/1000, Train Loss: 0.002763, Val Loss: 0.000332
Epoch 12/1000, Train Loss: 0.003183, Val Loss: 0.002294
Epoch 13/1000, Train Loss: 0.003325, Val Loss: 0.000946
Epoch 14/1000, Train Loss: 0.002359, Val Loss: 0.001285
Epoch 15/1000, Train Loss: 0.003496, Val Loss: 0.004150
Epoch 16/1000, Train Loss: 0.001951, Val Loss: 0.000307
Epoch 17/1000, Train Loss: 0.001854, Val Loss: 0.000300
Epoch 18/1000, Train Loss: 16.731213, Val Loss: 0.048416
Epoch 19/1000, Train Loss: 0.013805, Val Loss: 0.000624
Epoch 20/1000, Train Loss: 0.001730, Val Loss: 0.000979
Epoch 21/1000, Train Loss: 0.001547, Val Loss: 0.000554
Epoch 22/1000, Train Loss: 0.001468, Val Loss: 0.000721
Epoch 23/1000, Train Loss: 0.001296, Val Loss: 0.000502
Epoch 24/1000, Train Loss: 0.001477, Val Loss: 0.000557
Epoch 25/1000, Train Loss: 0.001274, Val Loss: 0.000573
Epoch 26/1000, Train Loss: 0.001503, Val Loss: 0.000270
Epoch 27/1000, Train Loss: 0.001238, Val Loss: 0.000517
Epoch 28/1000, Train Loss: 0.001283, Val Loss: 0.000323
Epoch 29/1000, Train Loss: 0.001181, Val Loss: 0.000245
Epoch 30/1000, Train Loss: 0.001300, Val Loss: 0.000536
Epoch 31/1000, Train Loss: 0.001414, Val Loss: 0.000257
Epoch 32/1000, Train Loss: 0.001237, Val Loss: 0.000237
Epoch 33/1000, Train Loss: 0.001176, Val Loss: 0.000366
Epoch 34/1000, Train Loss: 0.001131, Val Loss: 0.000448
Epoch 35/1000, Train Loss: 0.001152, Val Loss: 0.002011
Epoch 36/1000, Train Loss: 0.000948, Val Loss: 0.000412
Epoch 37/1000, Train Loss: 0.000870, Val Loss: 0.000223
Epoch 38/1000, Train Loss: 0.001127, Val Loss: 0.000578
Epoch 39/1000, Train Loss: 0.001304, Val Loss: 0.000393
Epoch 40/1000, Train Loss: 0.001076, Val Loss: 0.000228
Epoch 41/1000, Train Loss: 0.001228, Val Loss: 0.000435
Epoch 42/1000, Train Loss: 0.000884, Val Loss: 0.001735
Epoch 43/1000, Train Loss: 0.000946, Val Loss: 0.000161
Epoch 44/1000, Train Loss: 0.001036, Val Loss: 0.000997
Epoch 45/1000, Train Loss: 0.001117, Val Loss: 0.000154
Epoch 46/1000, Train Loss: 0.000832, Val Loss: 0.000530
Epoch 47/1000, Train Loss: 0.000971, Val Loss: 0.002149
Epoch 48/1000, Train Loss: 0.000709, Val Loss: 0.000331
Epoch 49/1000, Train Loss: 0.000703, Val Loss: 0.000612
Epoch 50/1000, Train Loss: 0.000608, Val Loss: 0.001010
Epoch 51/1000, Train Loss: 0.000747, Val Loss: 0.000983
Epoch 52/1000, Train Loss: 0.000682, Val Loss: 0.000331
Epoch 53/1000, Train Loss: 0.000631, Val Loss: 0.000102
Epoch 54/1000, Train Loss: 0.000918, Val Loss: 0.000318
Epoch 55/1000, Train Loss: 0.000461, Val Loss: 0.000334
Epoch 56/1000, Train Loss: 0.000941, Val Loss: 0.002152
Epoch 57/1000, Train Loss: 0.000908, Val Loss: 0.001928
Epoch 58/1000, Train Loss: 0.000643, Val Loss: 0.000113
Epoch 59/1000, Train Loss: 0.000572, Val Loss: 0.000343
Epoch 60/1000, Train Loss: 1.815203, Val Loss: 0.004041
Epoch 61/1000, Train Loss: 0.003757, Val Loss: 0.000722
Epoch 62/1000, Train Loss: 0.001975, Val Loss: 0.001634
Epoch 63/1000, Train Loss: 0.001857, Val Loss: 0.000715
Early stopping
Training completed
All predictions shape before reshape: (359, 65341, 1)
All targets shape before reshape: (359, 65341, 1)
All predictions shape after reshape: (359, 65341)
All targets shape after reshape: (359, 65341)
Results saved to multi_branch/array/gru_window_7_results.npy
Final Model Evaluation on Test Set:
RMSE: 0.0003, MAE: 0.0003, RÂ²: 0.9861, L2 Error: 0.0738
(0.00028879032, 0.00026432023, 0.986143731174233, 0.073820256)
