Using device: cuda
Train input shape: (4017, 12)
Validation input shape: (4018, 12)
Test input shape: (365, 12)
Training with window_size=60
Check the shapes of the generated sequences
-----------------------------------------
Train input shape: torch.Size([3958, 60, 12])
Train target shape: torch.Size([3958, 65341, 1])
Validation input shape: torch.Size([3959, 60, 12])
Validation target shape: torch.Size([3959, 65341, 1])
Test input shape: torch.Size([306, 60, 12])
Test target shape: torch.Size([306, 65341, 1])
-----------------------------------------
Create DataLoaders for training and validation sets
-----------------------------------------
Batch size: 16
Set the hyperparameters
-----------------------------------------
multi_branch/gru_window_60.pth
Number of epochs: 1000
Learning rate: 0.001
Patience: 10
Loss function: MSELoss()
-----------------------------------------
Epoch 1/1000, Train Loss: 25753.917506, Val Loss: 0.002608
Epoch 2/1000, Train Loss: 0.002841, Val Loss: 0.001962
Epoch 3/1000, Train Loss: 0.002161, Val Loss: 0.001752
Epoch 4/1000, Train Loss: 0.004071, Val Loss: 0.003475
Epoch 5/1000, Train Loss: 0.003203, Val Loss: 0.001524
Epoch 6/1000, Train Loss: 0.003605, Val Loss: 0.010461
Epoch 7/1000, Train Loss: 0.002727, Val Loss: 0.002220
Epoch 8/1000, Train Loss: 0.003230, Val Loss: 0.000590
Epoch 9/1000, Train Loss: 0.003321, Val Loss: 0.002127
Epoch 10/1000, Train Loss: 0.002509, Val Loss: 0.001776
Epoch 11/1000, Train Loss: 0.003114, Val Loss: 0.007437
Epoch 12/1000, Train Loss: 0.003460, Val Loss: 0.010155
Epoch 13/1000, Train Loss: 0.002354, Val Loss: 0.004474
Epoch 14/1000, Train Loss: 0.002888, Val Loss: 0.001474
Epoch 15/1000, Train Loss: 0.002780, Val Loss: 0.000378
Epoch 16/1000, Train Loss: 0.002591, Val Loss: 0.000840
Epoch 17/1000, Train Loss: 0.002846, Val Loss: 0.000323
Epoch 18/1000, Train Loss: 0.003018, Val Loss: 0.005824
Epoch 19/1000, Train Loss: 0.002306, Val Loss: 0.000304
Epoch 20/1000, Train Loss: 0.002677, Val Loss: 0.000314
Epoch 21/1000, Train Loss: 0.002407, Val Loss: 0.004925
Epoch 22/1000, Train Loss: 0.002240, Val Loss: 0.006864
Epoch 23/1000, Train Loss: 0.002228, Val Loss: 0.000279
Epoch 24/1000, Train Loss: 0.002663, Val Loss: 0.001158
Epoch 25/1000, Train Loss: 0.003132, Val Loss: 0.002204
Epoch 26/1000, Train Loss: 0.003626, Val Loss: 0.000399
Epoch 27/1000, Train Loss: 0.002182, Val Loss: 0.000284
Epoch 28/1000, Train Loss: 0.003136, Val Loss: 0.003170
Epoch 29/1000, Train Loss: 0.002391, Val Loss: 0.000602
Epoch 30/1000, Train Loss: 0.001958, Val Loss: 0.000593
Epoch 31/1000, Train Loss: 0.002927, Val Loss: 0.010109
Epoch 32/1000, Train Loss: 0.002424, Val Loss: 0.000228
Epoch 33/1000, Train Loss: 0.002405, Val Loss: 0.004340
Epoch 34/1000, Train Loss: 0.002265, Val Loss: 0.001207
Epoch 35/1000, Train Loss: 0.002784, Val Loss: 0.000541
Epoch 36/1000, Train Loss: 0.001591, Val Loss: 0.000338
Epoch 37/1000, Train Loss: 0.002705, Val Loss: 0.000430
Epoch 38/1000, Train Loss: 0.002728, Val Loss: 0.005860
Epoch 39/1000, Train Loss: 0.002103, Val Loss: 0.000327
Epoch 40/1000, Train Loss: 0.002144, Val Loss: 0.000544
Epoch 41/1000, Train Loss: 0.002313, Val Loss: 0.001072
Epoch 42/1000, Train Loss: 0.002145, Val Loss: 0.000399
Early stopping
Training completed
All predictions shape before reshape: (306, 65341, 1)
All targets shape before reshape: (306, 65341, 1)
All predictions shape after reshape: (306, 65341)
All targets shape after reshape: (306, 65341)
Predictions and targets saved to multi_branch/array/gru_window_60_preds_targets.npy
Results saved to multi_branch/array/gru_window_60_results.npy
Final Model Evaluation on Test Set:
RMSE: 0.0002, MAE: 0.0002, RÂ²: 0.9923, L2 Error: 0.0503
(0.00019660358, 0.00017463032, 0.992300873111079, 0.050255574)
