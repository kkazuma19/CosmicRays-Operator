Using device: cuda
Train input shape: (4017, 12)
Validation input shape: (4018, 12)
Test input shape: (365, 12)
Training with window_size=60
Check the shapes of the generated sequences
-----------------------------------------
Train input shape: torch.Size([3958, 60, 12])
Train target shape: torch.Size([3958, 65341, 1])
Validation input shape: torch.Size([3959, 60, 12])
Validation target shape: torch.Size([3959, 65341, 1])
Test input shape: torch.Size([306, 60, 12])
Test target shape: torch.Size([306, 65341, 1])
-----------------------------------------
Create DataLoaders for training and validation sets
-----------------------------------------
Batch size: 16
Set the hyperparameters
-----------------------------------------
multi_branch/gru_window_60.pth
Number of epochs: 1000
Learning rate: 0.001
Patience: 10
Loss function: MSELoss()
-----------------------------------------

--- Repetition 1/5 ---
Epoch 1: Train Loss = 1068.536805, Val Loss = 0.000745
Epoch 2: Train Loss = 0.002298, Val Loss = 0.003343
Epoch 3: Train Loss = 0.002027, Val Loss = 0.000443
Epoch 4: Train Loss = 0.002529, Val Loss = 0.001843
Epoch 5: Train Loss = 0.002811, Val Loss = 0.000528
Epoch 6: Train Loss = 0.004337, Val Loss = 0.000546
Epoch 7: Train Loss = 0.003352, Val Loss = 0.002505
Epoch 8: Train Loss = 0.003216, Val Loss = 0.000895
Epoch 9: Train Loss = 0.002672, Val Loss = 0.000461
Epoch 10: Train Loss = 0.002993, Val Loss = 0.000869
Epoch 11: Train Loss = 0.003230, Val Loss = 0.002401
Epoch 12: Train Loss = 0.003682, Val Loss = 0.000529
Epoch 13: Train Loss = 0.002376, Val Loss = 0.000362
Epoch 14: Train Loss = 0.002985, Val Loss = 0.000992
Epoch 15: Train Loss = 0.003286, Val Loss = 0.003130
Epoch 16: Train Loss = 0.003895, Val Loss = 0.002734
Epoch 17: Train Loss = 0.002599, Val Loss = 0.000701
Epoch 18: Train Loss = 0.002589, Val Loss = 0.000364
Epoch 19: Train Loss = 0.003840, Val Loss = 0.003946
Epoch 20: Train Loss = 0.002667, Val Loss = 0.000389
Epoch 21: Train Loss = 0.003965, Val Loss = 0.002085
Epoch 22: Train Loss = 0.002594, Val Loss = 0.000338
Epoch 23: Train Loss = 0.002508, Val Loss = 0.000522
Epoch 24: Train Loss = 0.003137, Val Loss = 0.001064
Epoch 25: Train Loss = 0.002878, Val Loss = 0.000479
Epoch 26: Train Loss = 0.003070, Val Loss = 0.006665
Epoch 27: Train Loss = 0.002859, Val Loss = 0.001885
Epoch 28: Train Loss = 0.002352, Val Loss = 0.001769
Epoch 29: Train Loss = 0.003558, Val Loss = 0.002680
Epoch 30: Train Loss = 0.002560, Val Loss = 0.001597
Epoch 31: Train Loss = 0.003510, Val Loss = 0.000377
Epoch 32: Train Loss = 0.002112, Val Loss = 0.002007
Early stopping at epoch 32
Repetition 1 finished: Total Time = 1117.65s, Time/sample = 0.008824s

--- Repetition 2/5 ---
Epoch 1: Train Loss = 4.691945, Val Loss = 0.000604
Epoch 2: Train Loss = 0.001318, Val Loss = 0.000608
Epoch 3: Train Loss = 0.001075, Val Loss = 0.000705
Epoch 4: Train Loss = 0.001089, Val Loss = 0.000721
Epoch 5: Train Loss = 0.001114, Val Loss = 0.000429
Epoch 6: Train Loss = 0.001280, Val Loss = 0.003338
Epoch 7: Train Loss = 0.001218, Val Loss = 0.000816
Epoch 8: Train Loss = 0.001051, Val Loss = 0.001056
Epoch 9: Train Loss = 0.001059, Val Loss = 0.000727
Epoch 10: Train Loss = 0.000892, Val Loss = 0.000477
Epoch 11: Train Loss = 0.000804, Val Loss = 0.000218
Epoch 12: Train Loss = 0.000816, Val Loss = 0.000275
Epoch 13: Train Loss = 0.000840, Val Loss = 0.001143
Epoch 14: Train Loss = 0.000922, Val Loss = 0.001628
Epoch 15: Train Loss = 0.000656, Val Loss = 0.000358
Epoch 16: Train Loss = 0.000710, Val Loss = 0.000259
Epoch 17: Train Loss = 0.000684, Val Loss = 0.000353
Epoch 18: Train Loss = 0.000885, Val Loss = 0.000697
Epoch 19: Train Loss = 0.001099, Val Loss = 0.000561
Epoch 20: Train Loss = 193112.809230, Val Loss = 0.185016
Epoch 21: Train Loss = 0.128666, Val Loss = 0.116239
Early stopping at epoch 21
Repetition 2 finished: Total Time = 738.10s, Time/sample = 0.008880s

--- Repetition 3/5 ---
Epoch 1: Train Loss = 527.145365, Val Loss = 0.014344
Epoch 2: Train Loss = 0.010889, Val Loss = 0.006935
Epoch 3: Train Loss = 0.007155, Val Loss = 0.004645
Epoch 4: Train Loss = 0.005135, Val Loss = 0.003218
Epoch 5: Train Loss = 0.004094, Val Loss = 0.003292
Epoch 6: Train Loss = 0.003497, Val Loss = 0.001966
Epoch 7: Train Loss = 0.003568, Val Loss = 0.001734
Epoch 8: Train Loss = 0.003233, Val Loss = 0.001593
Epoch 9: Train Loss = 0.002929, Val Loss = 0.001387
Epoch 10: Train Loss = 0.002497, Val Loss = 0.001576
Epoch 11: Train Loss = 0.003293, Val Loss = 0.004014
Epoch 12: Train Loss = 0.002665, Val Loss = 0.001080
Epoch 13: Train Loss = 0.002653, Val Loss = 0.002036
Epoch 14: Train Loss = 0.002526, Val Loss = 0.003311
Epoch 15: Train Loss = 0.002997, Val Loss = 0.007095
Epoch 16: Train Loss = 0.002277, Val Loss = 0.001486
Epoch 17: Train Loss = 0.002057, Val Loss = 0.000974
Epoch 18: Train Loss = 0.002335, Val Loss = 0.002428
Epoch 19: Train Loss = 0.002439, Val Loss = 0.000643
Epoch 20: Train Loss = 0.002563, Val Loss = 0.006661
Epoch 21: Train Loss = 0.002270, Val Loss = 0.002797
Epoch 22: Train Loss = 0.002471, Val Loss = 0.000775
Epoch 23: Train Loss = 0.002732, Val Loss = 0.001183
Epoch 24: Train Loss = 0.001731, Val Loss = 0.000576
Epoch 25: Train Loss = 0.002227, Val Loss = 0.004544
Epoch 26: Train Loss = 0.002128, Val Loss = 0.006872
Epoch 27: Train Loss = 0.002186, Val Loss = 0.001143
Epoch 28: Train Loss = 0.001983, Val Loss = 0.000617
Epoch 29: Train Loss = 6303.804109, Val Loss = 0.260078
Epoch 30: Train Loss = 2478.956794, Val Loss = 0.010081
Epoch 31: Train Loss = 0.007803, Val Loss = 0.007623
Epoch 32: Train Loss = 0.003480, Val Loss = 0.003562
Epoch 33: Train Loss = 0.002425, Val Loss = 0.002104
Epoch 34: Train Loss = 0.001859, Val Loss = 0.001372
Early stopping at epoch 34
Repetition 3 finished: Total Time = 1195.39s, Time/sample = 0.008883s

--- Repetition 4/5 ---
Epoch 1: Train Loss = 173212.087463, Val Loss = 0.000829
Epoch 2: Train Loss = 0.002144, Val Loss = 0.000820
Epoch 3: Train Loss = 0.001891, Val Loss = 0.000610
Epoch 4: Train Loss = 0.002094, Val Loss = 0.003119
Epoch 5: Train Loss = 0.002588, Val Loss = 0.000990
Epoch 6: Train Loss = 0.002836, Val Loss = 0.000527
Epoch 7: Train Loss = 0.004142, Val Loss = 0.000490
Epoch 8: Train Loss = 0.002047, Val Loss = 0.000770
Epoch 9: Train Loss = 0.002974, Val Loss = 0.010468
Epoch 10: Train Loss = 0.002753, Val Loss = 0.000495
Epoch 11: Train Loss = 0.003588, Val Loss = 0.000731
Epoch 12: Train Loss = 0.002414, Val Loss = 0.000513
Epoch 13: Train Loss = 0.003420, Val Loss = 0.000764
Epoch 14: Train Loss = 0.004310, Val Loss = 0.000694
Epoch 15: Train Loss = 0.002948, Val Loss = 0.002505
Epoch 16: Train Loss = 0.003679, Val Loss = 0.000795
Epoch 17: Train Loss = 0.002209, Val Loss = 0.000449
Epoch 18: Train Loss = 0.001723, Val Loss = 0.000922
Epoch 19: Train Loss = 0.002951, Val Loss = 0.001450
Epoch 20: Train Loss = 0.002736, Val Loss = 0.006271
Epoch 21: Train Loss = 0.003964, Val Loss = 0.000984
Epoch 22: Train Loss = 0.002425, Val Loss = 0.011436
Epoch 23: Train Loss = 0.002777, Val Loss = 0.003929
Epoch 24: Train Loss = 0.002585, Val Loss = 0.000728
Epoch 25: Train Loss = 0.002888, Val Loss = 0.001749
Epoch 26: Train Loss = 0.003527, Val Loss = 0.009572
Epoch 27: Train Loss = 0.002452, Val Loss = 0.001685
Early stopping at epoch 27
Repetition 4 finished: Total Time = 768.99s, Time/sample = 0.007196s

--- Repetition 5/5 ---
Epoch 1: Train Loss = 9.619159, Val Loss = 0.002067
Epoch 2: Train Loss = 0.002509, Val Loss = 0.004707
Epoch 3: Train Loss = 0.002761, Val Loss = 0.000669
Epoch 4: Train Loss = 0.002082, Val Loss = 0.005083
Epoch 5: Train Loss = 0.002852, Val Loss = 0.000531
Epoch 6: Train Loss = 0.002288, Val Loss = 0.002951
Epoch 7: Train Loss = 0.004150, Val Loss = 0.000372
Epoch 8: Train Loss = 0.002621, Val Loss = 0.007666
Epoch 9: Train Loss = 0.002335, Val Loss = 0.002949
Epoch 10: Train Loss = 0.002445, Val Loss = 0.002882
Epoch 11: Train Loss = 0.003277, Val Loss = 0.000335
Epoch 12: Train Loss = 0.003869, Val Loss = 0.000676
Epoch 13: Train Loss = 0.002724, Val Loss = 0.008287
Epoch 14: Train Loss = 0.003140, Val Loss = 0.007671
Epoch 15: Train Loss = 0.002870, Val Loss = 0.000371
Epoch 16: Train Loss = 0.002568, Val Loss = 0.002228
Epoch 17: Train Loss = 0.002241, Val Loss = 0.000354
Epoch 18: Train Loss = 0.003275, Val Loss = 0.003971
Epoch 19: Train Loss = 0.002926, Val Loss = 0.000457
Epoch 20: Train Loss = 0.002506, Val Loss = 0.002457
Epoch 21: Train Loss = 0.002907, Val Loss = 0.000304
Epoch 22: Train Loss = 0.001933, Val Loss = 0.002739
Epoch 23: Train Loss = 955149.637339, Val Loss = 0.793753
Epoch 24: Train Loss = 0.402496, Val Loss = 0.156944
Epoch 25: Train Loss = 0.084273, Val Loss = 0.089506
Epoch 26: Train Loss = 0.060345, Val Loss = 0.030070
Epoch 27: Train Loss = 0.053556, Val Loss = 0.034878
Epoch 28: Train Loss = 0.054368, Val Loss = 0.032267
Epoch 29: Train Loss = 0.054021, Val Loss = 0.069645
Epoch 30: Train Loss = 0.048412, Val Loss = 0.105111
Epoch 31: Train Loss = 0.046856, Val Loss = 0.022389
Early stopping at epoch 31
Repetition 5 finished: Total Time = 822.28s, Time/sample = 0.006702s

====== MIONet Training Time Benchmark ======
Run 1: Total = 1117.65s, Per Sample = 0.008824s
Run 2: Total = 738.10s, Per Sample = 0.008880s
Run 3: Total = 1195.39s, Per Sample = 0.008883s
Run 4: Total = 768.99s, Per Sample = 0.007196s
Run 5: Total = 822.28s, Per Sample = 0.006702s

Average Total Time: 928.48s
Average Time per Sample: 0.008097s
