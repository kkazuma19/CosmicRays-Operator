Using device: cuda
Train input shape: (4017, 12)
Validation input shape: (4018, 12)
Test input shape: (365, 12)
Training with window_size=90
Check the shapes of the generated sequences
-----------------------------------------
Train input shape: torch.Size([3928, 90, 12])
Train target shape: torch.Size([3928, 65341, 1])
Validation input shape: torch.Size([3929, 90, 12])
Validation target shape: torch.Size([3929, 65341, 1])
Test input shape: torch.Size([276, 90, 12])
Test target shape: torch.Size([276, 65341, 1])
-----------------------------------------
Create DataLoaders for training and validation sets
-----------------------------------------
Batch size: 16
SequentialDeepONet(
  (branch_net): GRU(
    (gru): GRU(12, 128, num_layers=4, batch_first=True)
    (layer_norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    (fc): Linear(in_features=128, out_features=128, bias=True)
  )
  (trunk_net): FCN(
    (network): Sequential(
      (0): Linear(in_features=2, out_features=128, bias=True)
      (1): ReLU()
      (2): Linear(in_features=128, out_features=128, bias=True)
      (3): ReLU()
      (4): Linear(in_features=128, out_features=128, bias=True)
    )
  )
)
Set the hyperparameters
-----------------------------------------
single_branch/gru_window_90_1.pth
Number of epochs: 1000
Learning rate: 0.001
Patience: 10
Loss function: MSELoss()
-----------------------------------------

--- Repetition 1/5 ---
Epoch 1: Train Loss: 0.088311, Val Loss: 0.000234
Epoch 2: Train Loss: 0.000584, Val Loss: 0.000102
Epoch 3: Train Loss: 0.000373, Val Loss: 0.000118
Epoch 4: Train Loss: 0.000251, Val Loss: 0.000152
Epoch 5: Train Loss: 0.000193, Val Loss: 0.000038
Epoch 6: Train Loss: 0.000139, Val Loss: 0.000047
Epoch 7: Train Loss: 0.000106, Val Loss: 0.000051
Epoch 8: Train Loss: 0.000099, Val Loss: 0.000077
Epoch 9: Train Loss: 0.000071, Val Loss: 0.000051
Epoch 10: Train Loss: 0.000090, Val Loss: 0.000052
Epoch 11: Train Loss: 0.000066, Val Loss: 0.000023
Epoch 12: Train Loss: 0.000100, Val Loss: 0.000042
Epoch 13: Train Loss: 0.000114, Val Loss: 0.000215
Epoch 14: Train Loss: 0.000105, Val Loss: 0.000026
Epoch 15: Train Loss: 0.000075, Val Loss: 0.000095
Epoch 16: Train Loss: 0.000093, Val Loss: 0.000133
Epoch 17: Train Loss: 0.000125, Val Loss: 0.000053
Epoch 18: Train Loss: 0.000082, Val Loss: 0.000017
Epoch 19: Train Loss: 0.000120, Val Loss: 0.000014
Epoch 20: Train Loss: 0.000117, Val Loss: 0.000119
Epoch 21: Train Loss: 0.000096, Val Loss: 0.000009
Epoch 22: Train Loss: 0.000107, Val Loss: 0.000054
Epoch 23: Train Loss: 0.000112, Val Loss: 0.000009
Epoch 24: Train Loss: 0.000100, Val Loss: 0.000018
Epoch 25: Train Loss: 0.000168, Val Loss: 0.000048
Epoch 26: Train Loss: 0.000071, Val Loss: 0.000349
Epoch 27: Train Loss: 0.000088, Val Loss: 0.000026
Epoch 28: Train Loss: 0.000147, Val Loss: 0.000057
Epoch 29: Train Loss: 0.000096, Val Loss: 0.000240
Epoch 30: Train Loss: 0.000117, Val Loss: 0.000043
Epoch 31: Train Loss: 0.000090, Val Loss: 0.000012
Epoch 32: Train Loss: 0.000052, Val Loss: 0.000026
Epoch 33: Train Loss: 0.019995, Val Loss: 0.000059
Early stopping at epoch 33
Repetition 1 completed: Total time = 891.50s, Time/sample = 0.006878s

--- Repetition 2/5 ---
Epoch 1: Train Loss: 0.073617, Val Loss: 0.000170
Epoch 2: Train Loss: 0.000552, Val Loss: 0.000100
Epoch 3: Train Loss: 0.000337, Val Loss: 0.000068
Epoch 4: Train Loss: 0.000220, Val Loss: 0.000057
Epoch 5: Train Loss: 0.000140, Val Loss: 0.000059
Epoch 6: Train Loss: 0.000104, Val Loss: 0.000058
Epoch 7: Train Loss: 0.000096, Val Loss: 0.000115
Epoch 8: Train Loss: 0.000086, Val Loss: 0.000119
Epoch 9: Train Loss: 0.000075, Val Loss: 0.000087
Epoch 10: Train Loss: 0.000072, Val Loss: 0.000028
Epoch 11: Train Loss: 0.000081, Val Loss: 0.000017
Epoch 12: Train Loss: 0.000084, Val Loss: 0.000067
Epoch 13: Train Loss: 0.000055, Val Loss: 0.000020
Epoch 14: Train Loss: 0.000069, Val Loss: 0.000034
Epoch 15: Train Loss: 0.000097, Val Loss: 0.000067
Epoch 16: Train Loss: 0.000073, Val Loss: 0.000146
Epoch 17: Train Loss: 0.000092, Val Loss: 0.000075
Epoch 18: Train Loss: 0.000111, Val Loss: 0.000037
Epoch 19: Train Loss: 0.000094, Val Loss: 0.000263
Epoch 20: Train Loss: 0.000237, Val Loss: 0.000075
Epoch 21: Train Loss: 0.000050, Val Loss: 0.000026
Early stopping at epoch 21
Repetition 2 completed: Total time = 568.80s, Time/sample = 0.006896s

--- Repetition 3/5 ---
Epoch 1: Train Loss: 0.100153, Val Loss: 0.000234
Epoch 2: Train Loss: 0.000640, Val Loss: 0.000101
Epoch 3: Train Loss: 0.000465, Val Loss: 0.000089
Epoch 4: Train Loss: 0.000310, Val Loss: 0.000069
Epoch 5: Train Loss: 0.000198, Val Loss: 0.000100
Epoch 6: Train Loss: 0.000139, Val Loss: 0.000396
Epoch 7: Train Loss: 0.000132, Val Loss: 0.000124
Epoch 8: Train Loss: 0.000106, Val Loss: 0.000060
Epoch 9: Train Loss: 0.000083, Val Loss: 0.000024
Epoch 10: Train Loss: 0.000083, Val Loss: 0.000463
Epoch 11: Train Loss: 0.000104, Val Loss: 0.000088
Epoch 12: Train Loss: 0.000114, Val Loss: 0.000178
Epoch 13: Train Loss: 0.000093, Val Loss: 0.000026
Epoch 14: Train Loss: 0.000083, Val Loss: 0.000018
Epoch 15: Train Loss: 0.000075, Val Loss: 0.000025
Epoch 16: Train Loss: 0.000123, Val Loss: 0.000568
Epoch 17: Train Loss: 0.000103, Val Loss: 0.000050
Epoch 18: Train Loss: 0.000106, Val Loss: 0.000342
Epoch 19: Train Loss: 0.000093, Val Loss: 0.000023
Epoch 20: Train Loss: 0.000181, Val Loss: 0.000059
Epoch 21: Train Loss: 0.000068, Val Loss: 0.000013
Epoch 22: Train Loss: 0.000192, Val Loss: 0.000133
Epoch 23: Train Loss: 0.000094, Val Loss: 0.000036
Epoch 24: Train Loss: 0.000138, Val Loss: 0.000032
Epoch 25: Train Loss: 0.000110, Val Loss: 0.000018
Epoch 26: Train Loss: 0.000279, Val Loss: 0.000032
Epoch 27: Train Loss: 0.000069, Val Loss: 0.000020
Epoch 28: Train Loss: 0.000089, Val Loss: 0.000015
Epoch 29: Train Loss: 0.000117, Val Loss: 0.000972
Epoch 30: Train Loss: 0.000084, Val Loss: 0.000020
Epoch 31: Train Loss: 0.000070, Val Loss: 0.000057
Early stopping at epoch 31
Repetition 3 completed: Total time = 834.44s, Time/sample = 0.006853s

--- Repetition 4/5 ---
Epoch 1: Train Loss: 0.062302, Val Loss: 0.000208
Epoch 2: Train Loss: 0.000531, Val Loss: 0.000131
Epoch 3: Train Loss: 0.000376, Val Loss: 0.000125
Epoch 4: Train Loss: 0.000230, Val Loss: 0.000086
Epoch 5: Train Loss: 0.000124, Val Loss: 0.000034
Epoch 6: Train Loss: 0.000110, Val Loss: 0.000026
Epoch 7: Train Loss: 0.000101, Val Loss: 0.000026
Epoch 8: Train Loss: 0.000100, Val Loss: 0.000033
Epoch 9: Train Loss: 0.000091, Val Loss: 0.000043
Epoch 10: Train Loss: 0.000075, Val Loss: 0.000039
Epoch 11: Train Loss: 0.000084, Val Loss: 0.000120
Epoch 12: Train Loss: 0.000082, Val Loss: 0.000053
Epoch 13: Train Loss: 0.000066, Val Loss: 0.000029
Epoch 14: Train Loss: 0.000137, Val Loss: 0.000022
Epoch 15: Train Loss: 0.000273, Val Loss: 0.000036
Epoch 16: Train Loss: 0.000096, Val Loss: 0.000074
Epoch 17: Train Loss: 0.000083, Val Loss: 0.000165
Epoch 18: Train Loss: 0.000188, Val Loss: 0.000016
Epoch 19: Train Loss: 0.000102, Val Loss: 0.000094
Epoch 20: Train Loss: 0.000087, Val Loss: 0.000021
Epoch 21: Train Loss: 0.000112, Val Loss: 0.000019
Epoch 22: Train Loss: 0.000092, Val Loss: 0.000058
Epoch 23: Train Loss: 0.000109, Val Loss: 0.000042
Epoch 24: Train Loss: 0.000086, Val Loss: 0.000049
Epoch 25: Train Loss: 0.000141, Val Loss: 0.000076
Epoch 26: Train Loss: 0.000149, Val Loss: 0.000020
Epoch 27: Train Loss: 0.000078, Val Loss: 0.000021
Epoch 28: Train Loss: 0.001082, Val Loss: 0.000020
Early stopping at epoch 28
Repetition 4 completed: Total time = 759.63s, Time/sample = 0.006907s

--- Repetition 5/5 ---
Epoch 1: Train Loss: 0.088340, Val Loss: 0.000539
Epoch 2: Train Loss: 0.000670, Val Loss: 0.000113
Epoch 3: Train Loss: 0.000488, Val Loss: 0.000101
Epoch 4: Train Loss: 0.000277, Val Loss: 0.000075
Epoch 5: Train Loss: 0.000223, Val Loss: 0.000104
Epoch 6: Train Loss: 0.000162, Val Loss: 0.000073
Epoch 7: Train Loss: 0.000111, Val Loss: 0.000039
Epoch 8: Train Loss: 0.000087, Val Loss: 0.000041
Epoch 9: Train Loss: 0.000080, Val Loss: 0.000044
Epoch 10: Train Loss: 0.000122, Val Loss: 0.000059
Epoch 11: Train Loss: 0.000079, Val Loss: 0.000028
Epoch 12: Train Loss: 0.000064, Val Loss: 0.000023
Epoch 13: Train Loss: 0.000087, Val Loss: 0.000029
Epoch 14: Train Loss: 0.000114, Val Loss: 0.000386
Epoch 15: Train Loss: 0.000109, Val Loss: 0.000310
Epoch 16: Train Loss: 0.000205, Val Loss: 0.000018
Epoch 17: Train Loss: 0.000098, Val Loss: 0.000042
Epoch 18: Train Loss: 0.000129, Val Loss: 0.000089
Epoch 19: Train Loss: 0.000139, Val Loss: 0.000026
Epoch 20: Train Loss: 0.000097, Val Loss: 0.000067
Epoch 21: Train Loss: 0.000105, Val Loss: 0.000031
Epoch 22: Train Loss: 0.000172, Val Loss: 0.000018
Epoch 23: Train Loss: 0.000138, Val Loss: 0.000177
Epoch 24: Train Loss: 0.000057, Val Loss: 0.000019
Epoch 25: Train Loss: 0.000130, Val Loss: 0.000018
Epoch 26: Train Loss: 0.000077, Val Loss: 0.000055
Epoch 27: Train Loss: 0.000107, Val Loss: 0.000246
Epoch 28: Train Loss: 0.000222, Val Loss: 0.000050
Epoch 29: Train Loss: 0.000070, Val Loss: 0.000018
Epoch 30: Train Loss: 0.000116, Val Loss: 0.000128
Epoch 31: Train Loss: 0.000322, Val Loss: 0.000020
Epoch 32: Train Loss: 0.000065, Val Loss: 0.000047
Early stopping at epoch 32
Repetition 5 completed: Total time = 785.30s, Time/sample = 0.006248s

====== Benchmark Summary ======
Run 1: Total = 891.50s, Per Sample = 0.006878s
Run 2: Total = 568.80s, Per Sample = 0.006896s
Run 3: Total = 834.44s, Per Sample = 0.006853s
Run 4: Total = 759.63s, Per Sample = 0.006907s
Run 5: Total = 785.30s, Per Sample = 0.006248s

Average Total Time: 767.93s
Average Time per Sample: 0.006756s
