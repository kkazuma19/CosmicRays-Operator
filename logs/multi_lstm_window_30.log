Using device: cuda
Train input shape: (4017, 12)
Validation input shape: (4018, 12)
Test input shape: (365, 12)
Training with window_size=30
Check the shapes of the generated sequences
-----------------------------------------
Train input shape: torch.Size([3988, 30, 12])
Train target shape: torch.Size([3988, 65341, 1])
Validation input shape: torch.Size([3989, 30, 12])
Validation target shape: torch.Size([3989, 65341, 1])
Test input shape: torch.Size([336, 30, 12])
Test target shape: torch.Size([336, 65341, 1])
-----------------------------------------
Create DataLoaders for training and validation sets
-----------------------------------------
Batch size: 16
Set the hyperparameters
-----------------------------------------
multi_branch/lstm_window_30.pth
Number of epochs: 1000
Learning rate: 0.001
Patience: 10
Loss function: MSELoss()
-----------------------------------------
Epoch 1/1000, Train Loss: 6377.166963, Val Loss: 0.485478
Epoch 2/1000, Train Loss: 0.441843, Val Loss: 0.386474
Epoch 3/1000, Train Loss: 0.342734, Val Loss: 0.286116
Epoch 4/1000, Train Loss: 0.259933, Val Loss: 0.213471
Epoch 5/1000, Train Loss: 0.195835, Val Loss: 0.163686
Epoch 6/1000, Train Loss: 0.178244, Val Loss: 0.123339
Epoch 7/1000, Train Loss: 0.116045, Val Loss: 0.095743
Epoch 8/1000, Train Loss: 0.090477, Val Loss: 0.073573
Epoch 9/1000, Train Loss: 0.071837, Val Loss: 0.058080
Epoch 10/1000, Train Loss: 0.057881, Val Loss: 0.046152
Epoch 11/1000, Train Loss: 0.047485, Val Loss: 0.037325
Epoch 12/1000, Train Loss: 0.039471, Val Loss: 0.030832
Epoch 13/1000, Train Loss: 0.032938, Val Loss: 0.023735
Epoch 14/1000, Train Loss: 0.028063, Val Loss: 0.022027
Epoch 15/1000, Train Loss: 0.024315, Val Loss: 0.018009
Epoch 16/1000, Train Loss: 0.021244, Val Loss: 0.015318
Epoch 17/1000, Train Loss: 0.018732, Val Loss: 0.012979
Epoch 18/1000, Train Loss: 0.016662, Val Loss: 0.010448
Epoch 19/1000, Train Loss: 0.014903, Val Loss: 0.010886
Epoch 20/1000, Train Loss: 0.013376, Val Loss: 0.009343
Epoch 21/1000, Train Loss: 0.011958, Val Loss: 0.006874
Epoch 22/1000, Train Loss: 0.010711, Val Loss: 0.006707
Epoch 23/1000, Train Loss: 0.009246, Val Loss: 0.006200
Epoch 24/1000, Train Loss: 0.007355, Val Loss: 0.005498
Epoch 25/1000, Train Loss: 0.004276, Val Loss: 0.003263
Epoch 26/1000, Train Loss: 0.003173, Val Loss: 0.001643
Epoch 27/1000, Train Loss: 0.002723, Val Loss: 0.001198
Epoch 28/1000, Train Loss: 0.002458, Val Loss: 0.001041
Epoch 29/1000, Train Loss: 0.002232, Val Loss: 0.001195
Epoch 30/1000, Train Loss: 0.002196, Val Loss: 0.000857
Epoch 31/1000, Train Loss: 0.002000, Val Loss: 0.000709
Epoch 32/1000, Train Loss: 0.001903, Val Loss: 0.001660
Epoch 33/1000, Train Loss: 0.001930, Val Loss: 0.000751
Epoch 34/1000, Train Loss: 0.001810, Val Loss: 0.000950
Epoch 35/1000, Train Loss: 0.001733, Val Loss: 0.000546
Epoch 36/1000, Train Loss: 0.001706, Val Loss: 0.000701
Epoch 37/1000, Train Loss: 0.001659, Val Loss: 0.000495
Epoch 38/1000, Train Loss: 0.001793, Val Loss: 0.000528
Epoch 39/1000, Train Loss: 0.001955, Val Loss: 0.000992
Epoch 40/1000, Train Loss: 0.001832, Val Loss: 0.000672
Epoch 41/1000, Train Loss: 0.001831, Val Loss: 0.000919
Epoch 42/1000, Train Loss: 0.001781, Val Loss: 0.000984
Epoch 43/1000, Train Loss: 0.001771, Val Loss: 0.000526
Epoch 44/1000, Train Loss: 0.001749, Val Loss: 0.000701
Epoch 45/1000, Train Loss: 0.001653, Val Loss: 0.000524
Epoch 46/1000, Train Loss: 0.001871, Val Loss: 0.000583
Epoch 47/1000, Train Loss: 0.001613, Val Loss: 0.000513
Early stopping
Training completed
All predictions shape before reshape: (336, 65341, 1)
All targets shape before reshape: (336, 65341, 1)
All predictions shape after reshape: (336, 65341)
All targets shape after reshape: (336, 65341)
Predictions and targets saved to multi_branch/array/lstm_window_30_preds_targets.npy
Results saved to multi_branch/array/lstm_window_30_results.npy
Final Model Evaluation on Test Set:
RMSE: 0.0003, MAE: 0.0003, RÂ²: 0.9848, L2 Error: 0.0739
(0.00028909356, 0.000251611, 0.9847775310013925, 0.073897764)
