Using device: cuda
Train input shape: (4017, 12)
Validation input shape: (4018, 12)
Test input shape: (365, 12)
Training with window_size=30
Check the shapes of the generated sequences
-----------------------------------------
Train input shape: torch.Size([3988, 30, 12])
Train target shape: torch.Size([3988, 65341, 1])
Validation input shape: torch.Size([3989, 30, 12])
Validation target shape: torch.Size([3989, 65341, 1])
Test input shape: torch.Size([336, 30, 12])
Test target shape: torch.Size([336, 65341, 1])
-----------------------------------------
Create DataLoaders for training and validation sets
-----------------------------------------
Batch size: 16
Set the hyperparameters
-----------------------------------------
multi_branch/lstm_window_30.pth
Number of epochs: 1000
Learning rate: 0.001
Patience: 10
Loss function: MSELoss()
-----------------------------------------

--- Repetition 1/5 ---
Epoch 1: Train Loss = 779.638935, Val Loss = 0.002747
Epoch 2: Train Loss = 0.005334, Val Loss = 0.004974
Epoch 3: Train Loss = 0.004888, Val Loss = 0.003136
Epoch 4: Train Loss = 0.004181, Val Loss = 0.001582
Epoch 5: Train Loss = 0.003743, Val Loss = 0.000663
Epoch 6: Train Loss = 0.003157, Val Loss = 0.000632
Epoch 7: Train Loss = 0.002613, Val Loss = 0.001337
Epoch 8: Train Loss = 0.002558, Val Loss = 0.000941
Epoch 9: Train Loss = 0.002132, Val Loss = 0.000475
Epoch 10: Train Loss = 0.001823, Val Loss = 0.000687
Epoch 11: Train Loss = 0.001537, Val Loss = 0.001060
Epoch 12: Train Loss = 0.001629, Val Loss = 0.000538
Epoch 13: Train Loss = 0.001663, Val Loss = 0.000510
Epoch 14: Train Loss = 0.001570, Val Loss = 0.000771
Epoch 15: Train Loss = 0.001605, Val Loss = 0.000747
Epoch 16: Train Loss = 0.001454, Val Loss = 0.000727
Epoch 17: Train Loss = 0.001479, Val Loss = 0.000672
Epoch 18: Train Loss = 0.001478, Val Loss = 0.000938
Epoch 19: Train Loss = 0.001583, Val Loss = 0.000593
Early stopping at epoch 19
Repetition 1 finished: Total Time = 688.04s, Time/sample = 0.009080s

--- Repetition 2/5 ---
Epoch 1: Train Loss = 2.056291, Val Loss = 0.004579
Epoch 2: Train Loss = 0.008448, Val Loss = 0.000798
Epoch 3: Train Loss = 0.001900, Val Loss = 0.000523
Epoch 4: Train Loss = 0.002001, Val Loss = 0.000472
Epoch 5: Train Loss = 0.002338, Val Loss = 0.000400
Epoch 6: Train Loss = 0.002317, Val Loss = 0.000588
Epoch 7: Train Loss = 0.003039, Val Loss = 0.003344
Epoch 8: Train Loss = 0.003749, Val Loss = 0.000374
Epoch 9: Train Loss = 0.003122, Val Loss = 0.001105
Epoch 10: Train Loss = 0.002690, Val Loss = 0.000463
Epoch 11: Train Loss = 0.003683, Val Loss = 0.000739
Epoch 12: Train Loss = 0.003664, Val Loss = 0.000715
Epoch 13: Train Loss = 0.004620, Val Loss = 0.000949
Epoch 14: Train Loss = 0.004222, Val Loss = 0.002086
Epoch 15: Train Loss = 0.003910, Val Loss = 0.003083
Epoch 16: Train Loss = 0.004420, Val Loss = 0.001223
Epoch 17: Train Loss = 0.004363, Val Loss = 0.005923
Epoch 18: Train Loss = 0.003744, Val Loss = 0.002405
Early stopping at epoch 18
Repetition 2 finished: Total Time = 647.93s, Time/sample = 0.009026s

--- Repetition 3/5 ---
Epoch 1: Train Loss = 6649.894824, Val Loss = 0.022972
Epoch 2: Train Loss = 0.019184, Val Loss = 0.013092
Epoch 3: Train Loss = 0.012234, Val Loss = 0.007813
Epoch 4: Train Loss = 0.009086, Val Loss = 0.006136
Epoch 5: Train Loss = 0.007462, Val Loss = 0.004418
Epoch 6: Train Loss = 0.006729, Val Loss = 0.004044
Epoch 7: Train Loss = 0.006275, Val Loss = 0.004829
Epoch 8: Train Loss = 0.006003, Val Loss = 0.003710
Epoch 9: Train Loss = 0.005682, Val Loss = 0.003065
Epoch 10: Train Loss = 0.005572, Val Loss = 0.003597
Epoch 11: Train Loss = 0.005301, Val Loss = 0.003214
Epoch 12: Train Loss = 0.005140, Val Loss = 0.001574
Epoch 13: Train Loss = 0.005029, Val Loss = 0.002245
Epoch 14: Train Loss = 0.004785, Val Loss = 0.003038
Epoch 15: Train Loss = 0.004465, Val Loss = 0.002440
Epoch 16: Train Loss = 0.004272, Val Loss = 0.002431
Epoch 17: Train Loss = 0.004100, Val Loss = 0.001052
Epoch 18: Train Loss = 0.003890, Val Loss = 0.002843
Epoch 19: Train Loss = 0.003521, Val Loss = 0.000991
Epoch 20: Train Loss = 0.003208, Val Loss = 0.000757
Epoch 21: Train Loss = 0.003230, Val Loss = 0.002052
Epoch 22: Train Loss = 0.002717, Val Loss = 0.001129
Epoch 23: Train Loss = 0.002671, Val Loss = 0.001256
Epoch 24: Train Loss = 0.002576, Val Loss = 0.003074
Epoch 25: Train Loss = 0.002896, Val Loss = 0.000453
Epoch 26: Train Loss = 0.002158, Val Loss = 0.000483
Epoch 27: Train Loss = 0.002039, Val Loss = 0.000958
Epoch 28: Train Loss = 0.002002, Val Loss = 0.000597
Epoch 29: Train Loss = 0.002014, Val Loss = 0.003771
Epoch 30: Train Loss = 0.001929, Val Loss = 0.001004
Epoch 31: Train Loss = 0.002070, Val Loss = 0.001583
Epoch 32: Train Loss = 0.002021, Val Loss = 0.000465
Epoch 33: Train Loss = 0.001999, Val Loss = 0.001200
Epoch 34: Train Loss = 0.001730, Val Loss = 0.001844
Epoch 35: Train Loss = 0.001974, Val Loss = 0.000443
Epoch 36: Train Loss = 0.001919, Val Loss = 0.000530
Epoch 37: Train Loss = 0.001760, Val Loss = 0.001895
Epoch 38: Train Loss = 0.001872, Val Loss = 0.002090
Epoch 39: Train Loss = 0.001675, Val Loss = 0.000468
Epoch 40: Train Loss = 0.001676, Val Loss = 0.001070
Epoch 41: Train Loss = 0.001758, Val Loss = 0.000889
Epoch 42: Train Loss = 0.001829, Val Loss = 0.000528
Epoch 43: Train Loss = 0.001899, Val Loss = 0.000860
Epoch 44: Train Loss = 0.002055, Val Loss = 0.000960
Epoch 45: Train Loss = 0.001742, Val Loss = 0.000500
Early stopping at epoch 45
Repetition 3 finished: Total Time = 1685.03s, Time/sample = 0.009389s

--- Repetition 4/5 ---
Epoch 1: Train Loss = 0.130732, Val Loss = 0.001222
Epoch 2: Train Loss = 0.002658, Val Loss = 0.002002
Epoch 3: Train Loss = 0.003157, Val Loss = 0.011879
Epoch 4: Train Loss = 0.005883, Val Loss = 0.001496
Epoch 5: Train Loss = 0.003644, Val Loss = 0.000799
Epoch 6: Train Loss = 0.003470, Val Loss = 0.000318
Epoch 7: Train Loss = 0.004754, Val Loss = 0.000326
Epoch 8: Train Loss = 0.003259, Val Loss = 0.000900
Epoch 9: Train Loss = 0.003507, Val Loss = 0.002630
Epoch 10: Train Loss = 0.005318, Val Loss = 0.002318
Epoch 11: Train Loss = 0.002791, Val Loss = 0.001446
Epoch 12: Train Loss = 0.004567, Val Loss = 0.005690
Epoch 13: Train Loss = 0.001555, Val Loss = 0.010009
Epoch 14: Train Loss = 0.002549, Val Loss = 0.000350
Epoch 15: Train Loss = 8970.922915, Val Loss = 0.262108
Epoch 16: Train Loss = 0.020450, Val Loss = 0.003424
Early stopping at epoch 16
Repetition 4 finished: Total Time = 514.72s, Time/sample = 0.008067s

--- Repetition 5/5 ---
Epoch 1: Train Loss = 15.506198, Val Loss = 0.003213
Epoch 2: Train Loss = 0.015007, Val Loss = 0.050704
Epoch 3: Train Loss = 0.011277, Val Loss = 0.001178
Epoch 4: Train Loss = 0.005936, Val Loss = 0.001796
Epoch 5: Train Loss = 0.003261, Val Loss = 0.002322
Epoch 6: Train Loss = 0.003163, Val Loss = 0.003033
Epoch 7: Train Loss = 0.002274, Val Loss = 0.000438
Epoch 8: Train Loss = 0.002239, Val Loss = 0.000762
Epoch 9: Train Loss = 0.002631, Val Loss = 0.000577
Epoch 10: Train Loss = 0.003198, Val Loss = 0.000425
Epoch 11: Train Loss = 0.003025, Val Loss = 0.008024
Epoch 12: Train Loss = 0.004265, Val Loss = 0.003009
Epoch 13: Train Loss = 0.003784, Val Loss = 0.000472
Epoch 14: Train Loss = 0.003403, Val Loss = 0.007314
Epoch 15: Train Loss = 0.004299, Val Loss = 0.000849
Epoch 16: Train Loss = 0.004241, Val Loss = 0.001490
Epoch 17: Train Loss = 0.002463, Val Loss = 0.001760
Epoch 18: Train Loss = 0.003473, Val Loss = 0.005372
Epoch 19: Train Loss = 0.003558, Val Loss = 0.002756
Epoch 20: Train Loss = 0.002530, Val Loss = 0.000605
Early stopping at epoch 20
Repetition 5 finished: Total Time = 583.37s, Time/sample = 0.007314s

====== MIONet Training Time Benchmark ======
Run 1: Total = 688.04s, Per Sample = 0.009080s
Run 2: Total = 647.93s, Per Sample = 0.009026s
Run 3: Total = 1685.03s, Per Sample = 0.009389s
Run 4: Total = 514.72s, Per Sample = 0.008067s
Run 5: Total = 583.37s, Per Sample = 0.007314s

Average Total Time: 823.82s
Average Time per Sample: 0.008575s
