Using device: cuda
Train input shape: (4017, 12)
Validation input shape: (4018, 12)
Test input shape: (365, 12)
Training with window_size=30
Check the shapes of the generated sequences
-----------------------------------------
Train input shape: torch.Size([3988, 30, 12])
Train target shape: torch.Size([3988, 65341, 1])
Validation input shape: torch.Size([3989, 30, 12])
Validation target shape: torch.Size([3989, 65341, 1])
Test input shape: torch.Size([336, 30, 12])
Test target shape: torch.Size([336, 65341, 1])
-----------------------------------------
Create DataLoaders for training and validation sets
-----------------------------------------
Batch size: 16
Set the hyperparameters
-----------------------------------------
multi_branch/lstm_window_30.pth
Number of epochs: 1000
Learning rate: 0.001
Patience: 10
Loss function: MSELoss()
-----------------------------------------
Epoch 1/1000, Train Loss: 63.708635, Val Loss: 0.005061
Epoch 2/1000, Train Loss: 0.010533, Val Loss: 0.002051
Epoch 3/1000, Train Loss: 0.009299, Val Loss: 0.013382
Epoch 4/1000, Train Loss: 0.007968, Val Loss: 0.011332
Epoch 5/1000, Train Loss: 0.006864, Val Loss: 0.003346
Epoch 6/1000, Train Loss: 0.004666, Val Loss: 0.000885
Epoch 7/1000, Train Loss: 0.003209, Val Loss: 0.000962
Epoch 8/1000, Train Loss: 0.002417, Val Loss: 0.002606
Epoch 9/1000, Train Loss: 0.003662, Val Loss: 0.000923
Epoch 10/1000, Train Loss: 0.002559, Val Loss: 0.000609
Epoch 11/1000, Train Loss: 0.003595, Val Loss: 0.000733
Epoch 12/1000, Train Loss: 0.002520, Val Loss: 0.000606
Epoch 13/1000, Train Loss: 0.003455, Val Loss: 0.002851
Epoch 14/1000, Train Loss: 0.003175, Val Loss: 0.014930
Epoch 15/1000, Train Loss: 0.002907, Val Loss: 0.000807
Epoch 16/1000, Train Loss: 0.002870, Val Loss: 0.002399
Epoch 17/1000, Train Loss: 0.003138, Val Loss: 0.000678
Epoch 18/1000, Train Loss: 0.002208, Val Loss: 0.001525
Epoch 19/1000, Train Loss: 0.002884, Val Loss: 0.000554
Epoch 20/1000, Train Loss: 0.002508, Val Loss: 0.001061
Epoch 21/1000, Train Loss: 0.002992, Val Loss: 0.001675
Epoch 22/1000, Train Loss: 0.002527, Val Loss: 0.005971
Epoch 23/1000, Train Loss: 0.002427, Val Loss: 0.000849
Epoch 24/1000, Train Loss: 0.002657, Val Loss: 0.001734
Epoch 25/1000, Train Loss: 0.002613, Val Loss: 0.001976
Epoch 26/1000, Train Loss: 0.002761, Val Loss: 0.000722
Epoch 27/1000, Train Loss: 0.002250, Val Loss: 0.001250
Epoch 28/1000, Train Loss: 0.001852, Val Loss: 0.000987
Epoch 29/1000, Train Loss: 0.001853, Val Loss: 0.000907
Early stopping
Training completed
All predictions shape before reshape: (336, 65341, 1)
All targets shape before reshape: (336, 65341, 1)
All predictions shape after reshape: (336, 65341)
All targets shape after reshape: (336, 65341)
Results saved to multi_branch/array/lstm_window_30_results.npy
Final Model Evaluation on Test Set:
RMSE: 0.0003, MAE: 0.0003, RÂ²: 0.9814, L2 Error: 0.0789
(0.0003084827, 0.00027177713, 0.9813571603503771, 0.078853995)
