Using device: cuda
Train input shape: (4017, 12)
Validation input shape: (4018, 12)
Test input shape: (365, 12)
Training with window_size=60
Check the shapes of the generated sequences
-----------------------------------------
Train input shape: torch.Size([3958, 60, 12])
Train target shape: torch.Size([3958, 65341, 1])
Validation input shape: torch.Size([3959, 60, 12])
Validation target shape: torch.Size([3959, 65341, 1])
Test input shape: torch.Size([306, 60, 12])
Test target shape: torch.Size([306, 65341, 1])
-----------------------------------------
Create DataLoaders for training and validation sets
-----------------------------------------
Batch size: 16
SequentialDeepONet(
  (branch_net): LSTM(
    (lstm): LSTM(12, 128, num_layers=4, batch_first=True)
    (layer_norm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    (fc): Linear(in_features=128, out_features=128, bias=True)
  )
  (trunk_net): FCN(
    (network): Sequential(
      (0): Linear(in_features=2, out_features=128, bias=True)
      (1): ReLU()
      (2): Linear(in_features=128, out_features=128, bias=True)
      (3): ReLU()
      (4): Linear(in_features=128, out_features=128, bias=True)
    )
  )
)
Set the hyperparameters
-----------------------------------------
single_branch/lstm_window_60_1.pth
Number of epochs: 1000
Learning rate: 0.001
Patience: 10
Loss function: MSELoss()
-----------------------------------------

--- Repetition 1/5 ---
Epoch 1: Train Loss: 0.044035, Val Loss: 0.000443
Epoch 2: Train Loss: 0.001315, Val Loss: 0.000435
Epoch 3: Train Loss: 0.001204, Val Loss: 0.000502
Epoch 4: Train Loss: 0.001136, Val Loss: 0.000197
Epoch 5: Train Loss: 0.000891, Val Loss: 0.000174
Epoch 6: Train Loss: 0.000716, Val Loss: 0.000074
Epoch 7: Train Loss: 0.000445, Val Loss: 0.000108
Epoch 8: Train Loss: 0.000208, Val Loss: 0.000245
Epoch 9: Train Loss: 0.000090, Val Loss: 0.000017
Epoch 10: Train Loss: 0.000049, Val Loss: 0.000248
Epoch 11: Train Loss: 0.000051, Val Loss: 0.000014
Epoch 12: Train Loss: 0.000049, Val Loss: 0.000022
Epoch 13: Train Loss: 0.000050, Val Loss: 0.000199
Epoch 14: Train Loss: 0.000041, Val Loss: 0.001100
Epoch 15: Train Loss: 0.000085, Val Loss: 0.000023
Epoch 16: Train Loss: 0.000070, Val Loss: 0.000217
Epoch 17: Train Loss: 0.000108, Val Loss: 0.000011
Epoch 18: Train Loss: 0.000116, Val Loss: 0.000018
Epoch 19: Train Loss: 0.000094, Val Loss: 0.000013
Epoch 20: Train Loss: 0.000074, Val Loss: 0.000013
Epoch 21: Train Loss: 0.000110, Val Loss: 0.000027
Epoch 22: Train Loss: 0.000153, Val Loss: 0.000233
Epoch 23: Train Loss: 0.000098, Val Loss: 0.000026
Epoch 24: Train Loss: 0.000215, Val Loss: 0.000248
Epoch 25: Train Loss: 0.000077, Val Loss: 0.000039
Epoch 26: Train Loss: 0.000046, Val Loss: 0.000067
Epoch 27: Train Loss: 0.000074, Val Loss: 0.000017
Early stopping at epoch 27
Repetition 1 completed: Total time = 728.67s, Time/sample = 0.006819s

--- Repetition 2/5 ---
Epoch 1: Train Loss: 0.061261, Val Loss: 0.000437
Epoch 2: Train Loss: 0.001247, Val Loss: 0.001305
Epoch 3: Train Loss: 0.001162, Val Loss: 0.000330
Epoch 4: Train Loss: 0.001015, Val Loss: 0.001041
Epoch 5: Train Loss: 0.000962, Val Loss: 0.000566
Epoch 6: Train Loss: 0.000846, Val Loss: 0.000119
Epoch 7: Train Loss: 0.000520, Val Loss: 0.000223
Epoch 8: Train Loss: 0.000315, Val Loss: 0.000314
Epoch 9: Train Loss: 0.000329, Val Loss: 0.000029
Epoch 10: Train Loss: 0.000099, Val Loss: 0.000035
Epoch 11: Train Loss: 0.000053, Val Loss: 0.000036
Epoch 12: Train Loss: 0.000056, Val Loss: 0.000067
Epoch 13: Train Loss: 0.000063, Val Loss: 0.000020
Epoch 14: Train Loss: 0.000068, Val Loss: 0.000016
Epoch 15: Train Loss: 0.000122, Val Loss: 0.000016
Epoch 16: Train Loss: 0.000102, Val Loss: 0.000046
Epoch 17: Train Loss: 0.000099, Val Loss: 0.000057
Epoch 18: Train Loss: 0.000060, Val Loss: 0.000056
Epoch 19: Train Loss: 0.000705, Val Loss: 0.000067
Epoch 20: Train Loss: 0.000062, Val Loss: 0.000028
Epoch 21: Train Loss: 0.000034, Val Loss: 0.000008
Epoch 22: Train Loss: 0.000043, Val Loss: 0.000292
Epoch 23: Train Loss: 0.000053, Val Loss: 0.000009
Epoch 24: Train Loss: 0.000153, Val Loss: 0.000093
Epoch 25: Train Loss: 0.000072, Val Loss: 0.000026
Epoch 26: Train Loss: 0.000052, Val Loss: 0.000015
Epoch 27: Train Loss: 0.000097, Val Loss: 0.000077
Epoch 28: Train Loss: 0.000065, Val Loss: 0.000018
Epoch 29: Train Loss: 0.000069, Val Loss: 0.000096
Epoch 30: Train Loss: 0.000072, Val Loss: 0.000069
Epoch 31: Train Loss: 0.000219, Val Loss: 0.000680
Early stopping at epoch 31
Repetition 2 completed: Total time = 827.99s, Time/sample = 0.006748s

--- Repetition 3/5 ---
Epoch 1: Train Loss: 0.095035, Val Loss: 0.000407
Epoch 2: Train Loss: 0.001370, Val Loss: 0.000329
Epoch 3: Train Loss: 0.001244, Val Loss: 0.000475
Epoch 4: Train Loss: 0.001011, Val Loss: 0.000289
Epoch 5: Train Loss: 0.000936, Val Loss: 0.000275
Epoch 6: Train Loss: 0.000840, Val Loss: 0.000388
Epoch 7: Train Loss: 0.000760, Val Loss: 0.000203
Epoch 8: Train Loss: 0.000541, Val Loss: 0.000166
Epoch 9: Train Loss: 0.000456, Val Loss: 0.000168
Epoch 10: Train Loss: 0.000166, Val Loss: 0.000049
Epoch 11: Train Loss: 0.000098, Val Loss: 0.000023
Epoch 12: Train Loss: 0.000081, Val Loss: 0.000015
Epoch 13: Train Loss: 0.000065, Val Loss: 0.000098
Epoch 14: Train Loss: 0.000084, Val Loss: 0.000077
Epoch 15: Train Loss: 0.000049, Val Loss: 0.000018
Epoch 16: Train Loss: 0.000052, Val Loss: 0.000013
Epoch 17: Train Loss: 0.000095, Val Loss: 0.000281
Epoch 18: Train Loss: 0.000114, Val Loss: 0.000036
Epoch 19: Train Loss: 0.000085, Val Loss: 0.000011
Epoch 20: Train Loss: 0.000308, Val Loss: 0.000017
Epoch 21: Train Loss: 0.000049, Val Loss: 0.000019
Epoch 22: Train Loss: 0.000065, Val Loss: 0.000020
Epoch 23: Train Loss: 0.000081, Val Loss: 0.000015
Epoch 24: Train Loss: 0.000074, Val Loss: 0.000033
Epoch 25: Train Loss: 0.000124, Val Loss: 0.000114
Epoch 26: Train Loss: 0.000176, Val Loss: 0.000037
Epoch 27: Train Loss: 0.000069, Val Loss: 0.000020
Epoch 28: Train Loss: 0.000073, Val Loss: 0.000020
Epoch 29: Train Loss: 0.000083, Val Loss: 0.000100
Early stopping at epoch 29
Repetition 3 completed: Total time = 780.02s, Time/sample = 0.006796s

--- Repetition 4/5 ---
Epoch 1: Train Loss: 0.051162, Val Loss: 0.000378
Epoch 2: Train Loss: 0.001464, Val Loss: 0.000310
Epoch 3: Train Loss: 0.001399, Val Loss: 0.000547
Epoch 4: Train Loss: 0.001143, Val Loss: 0.000497
Epoch 5: Train Loss: 0.001002, Val Loss: 0.000273
Epoch 6: Train Loss: 0.000875, Val Loss: 0.000149
Epoch 7: Train Loss: 0.000562, Val Loss: 0.000260
Epoch 8: Train Loss: 0.000410, Val Loss: 0.000045
Epoch 9: Train Loss: 0.000260, Val Loss: 0.000037
Epoch 10: Train Loss: 0.000101, Val Loss: 0.000458
Epoch 11: Train Loss: 0.000080, Val Loss: 0.000053
Epoch 12: Train Loss: 0.000106, Val Loss: 0.000028
Epoch 13: Train Loss: 0.000058, Val Loss: 0.000025
Epoch 14: Train Loss: 0.000057, Val Loss: 0.000028
Epoch 15: Train Loss: 0.000067, Val Loss: 0.000044
Epoch 16: Train Loss: 0.000082, Val Loss: 0.000057
Epoch 17: Train Loss: 0.000071, Val Loss: 0.000023
Epoch 18: Train Loss: 0.000215, Val Loss: 0.000881
Epoch 19: Train Loss: 0.000095, Val Loss: 0.000030
Epoch 20: Train Loss: 0.000137, Val Loss: 0.000030
Epoch 21: Train Loss: 0.000172, Val Loss: 0.000009
Epoch 22: Train Loss: 0.000076, Val Loss: 0.000024
Epoch 23: Train Loss: 0.000103, Val Loss: 0.000194
Epoch 24: Train Loss: 0.000094, Val Loss: 0.000018
Epoch 25: Train Loss: 0.000174, Val Loss: 0.000496
Epoch 26: Train Loss: 0.000150, Val Loss: 0.000049
Epoch 27: Train Loss: 0.000052, Val Loss: 0.000028
Epoch 28: Train Loss: 0.000103, Val Loss: 0.002626
Epoch 29: Train Loss: 0.000644, Val Loss: 0.000024
Epoch 30: Train Loss: 0.000046, Val Loss: 0.000007
Epoch 31: Train Loss: 0.000031, Val Loss: 0.000012
Epoch 32: Train Loss: 0.000046, Val Loss: 0.000016
Epoch 33: Train Loss: 0.000051, Val Loss: 0.000011
Epoch 34: Train Loss: 0.000066, Val Loss: 0.000021
Epoch 35: Train Loss: 0.000063, Val Loss: 0.000020
Epoch 36: Train Loss: 0.000165, Val Loss: 0.000029
Epoch 37: Train Loss: 0.000040, Val Loss: 0.000009
Epoch 38: Train Loss: 0.000047, Val Loss: 0.000008
Epoch 39: Train Loss: 0.000131, Val Loss: 0.000010
Epoch 40: Train Loss: 0.000048, Val Loss: 0.000015
Early stopping at epoch 40
Repetition 4 completed: Total time = 1066.39s, Time/sample = 0.006736s

--- Repetition 5/5 ---
Epoch 1: Train Loss: 0.063673, Val Loss: 0.001001
Epoch 2: Train Loss: 0.001370, Val Loss: 0.000323
Epoch 3: Train Loss: 0.001177, Val Loss: 0.000265
Epoch 4: Train Loss: 0.000961, Val Loss: 0.000228
Epoch 5: Train Loss: 0.000826, Val Loss: 0.000187
Epoch 6: Train Loss: 0.000639, Val Loss: 0.000130
Epoch 7: Train Loss: 0.000437, Val Loss: 0.000116
Epoch 8: Train Loss: 0.000277, Val Loss: 0.000032
Epoch 9: Train Loss: 0.000140, Val Loss: 0.000085
Epoch 10: Train Loss: 0.000100, Val Loss: 0.000037
Epoch 11: Train Loss: 0.000075, Val Loss: 0.000023
Epoch 12: Train Loss: 0.000074, Val Loss: 0.000037
Epoch 13: Train Loss: 0.000094, Val Loss: 0.000164
Epoch 14: Train Loss: 0.000072, Val Loss: 0.000034
Epoch 15: Train Loss: 0.000058, Val Loss: 0.000120
Epoch 16: Train Loss: 0.000179, Val Loss: 0.000019
Epoch 17: Train Loss: 0.000067, Val Loss: 0.000031
Epoch 18: Train Loss: 0.000059, Val Loss: 0.000022
Epoch 19: Train Loss: 0.000046, Val Loss: 0.000015
Epoch 20: Train Loss: 0.000081, Val Loss: 0.000015
Epoch 21: Train Loss: 0.000080, Val Loss: 0.000270
Epoch 22: Train Loss: 0.000116, Val Loss: 0.000054
Epoch 23: Train Loss: 0.000185, Val Loss: 0.000037
Epoch 24: Train Loss: 0.000051, Val Loss: 0.000073
Epoch 25: Train Loss: 0.000074, Val Loss: 0.000648
Epoch 26: Train Loss: 0.000114, Val Loss: 0.000007
Epoch 27: Train Loss: 0.000168, Val Loss: 0.002677
Epoch 28: Train Loss: 0.000127, Val Loss: 0.000013
Epoch 29: Train Loss: 0.000068, Val Loss: 0.000009
Epoch 30: Train Loss: 0.000036, Val Loss: 0.000032
Epoch 31: Train Loss: 0.000177, Val Loss: 0.000309
Epoch 32: Train Loss: 0.000088, Val Loss: 0.000038
Epoch 33: Train Loss: 0.000045, Val Loss: 0.000007
Epoch 34: Train Loss: 0.000037, Val Loss: 0.000300
Epoch 35: Train Loss: 0.000253, Val Loss: 0.000466
Epoch 36: Train Loss: 0.000072, Val Loss: 0.000032
Epoch 37: Train Loss: 0.000042, Val Loss: 0.000023
Epoch 38: Train Loss: 0.000108, Val Loss: 0.000075
Epoch 39: Train Loss: 0.000130, Val Loss: 0.000094
Epoch 40: Train Loss: 0.000087, Val Loss: 0.000013
Epoch 41: Train Loss: 0.000046, Val Loss: 0.000018
Epoch 42: Train Loss: 0.000041, Val Loss: 0.000008
Epoch 43: Train Loss: 0.000059, Val Loss: 0.000031
Early stopping at epoch 43
Repetition 5 completed: Total time = 977.58s, Time/sample = 0.005744s

====== Benchmark Summary ======
Run 1: Total = 728.67s, Per Sample = 0.006819s
Run 2: Total = 827.99s, Per Sample = 0.006748s
Run 3: Total = 780.02s, Per Sample = 0.006796s
Run 4: Total = 1066.39s, Per Sample = 0.006736s
Run 5: Total = 977.58s, Per Sample = 0.005744s

Average Total Time: 876.13s
Average Time per Sample: 0.006568s
