Using device: cuda
Train input shape: (4017, 12)
Validation input shape: (4018, 12)
Test input shape: (365, 12)
Training with window_size=7
Check the shapes of the generated sequences
-----------------------------------------
Train input shape: torch.Size([4011, 7, 12])
Train target shape: torch.Size([4011, 65341, 1])
Validation input shape: torch.Size([4012, 7, 12])
Validation target shape: torch.Size([4012, 65341, 1])
Test input shape: torch.Size([359, 7, 12])
Test target shape: torch.Size([359, 65341, 1])
-----------------------------------------
Create DataLoaders for training and validation sets
-----------------------------------------
Batch size: 16
Set the hyperparameters
-----------------------------------------
multi_branch/lstm_window_7.pth
Number of epochs: 1000
Learning rate: 0.001
Patience: 10
Loss function: MSELoss()
-----------------------------------------

--- Repetition 1/5 ---
Epoch 1: Train Loss = 83.273339, Val Loss = 0.003429
Epoch 2: Train Loss = 0.015654, Val Loss = 0.004194
Epoch 3: Train Loss = 0.013800, Val Loss = 0.019723
Epoch 4: Train Loss = 0.012245, Val Loss = 0.002667
Epoch 5: Train Loss = 0.011320, Val Loss = 0.002411
Epoch 6: Train Loss = 0.010491, Val Loss = 0.006880
Epoch 7: Train Loss = 0.004378, Val Loss = 0.000751
Epoch 8: Train Loss = 0.002566, Val Loss = 0.000459
Epoch 9: Train Loss = 0.002619, Val Loss = 0.000783
Epoch 10: Train Loss = 0.002595, Val Loss = 0.000698
Epoch 11: Train Loss = 0.002723, Val Loss = 0.000794
Epoch 12: Train Loss = 0.002307, Val Loss = 0.004229
Epoch 13: Train Loss = 0.002692, Val Loss = 0.000807
Epoch 14: Train Loss = 0.003228, Val Loss = 0.002006
Epoch 15: Train Loss = 0.002314, Val Loss = 0.000636
Epoch 16: Train Loss = 0.003156, Val Loss = 0.000806
Epoch 17: Train Loss = 0.002629, Val Loss = 0.014574
Epoch 18: Train Loss = 0.002435, Val Loss = 0.002252
Early stopping at epoch 18
Repetition 1 finished: Total Time = 623.42s, Time/sample = 0.008635s

--- Repetition 2/5 ---
Epoch 1: Train Loss = 0.310271, Val Loss = 0.000912
Epoch 2: Train Loss = 0.002277, Val Loss = 0.000901
Epoch 3: Train Loss = 0.002338, Val Loss = 0.000474
Epoch 4: Train Loss = 0.002596, Val Loss = 0.000490
Epoch 5: Train Loss = 0.001713, Val Loss = 0.001360
Epoch 6: Train Loss = 0.002025, Val Loss = 0.000842
Epoch 7: Train Loss = 0.002064, Val Loss = 0.002397
Epoch 8: Train Loss = 0.002115, Val Loss = 0.000602
Epoch 9: Train Loss = 0.001936, Val Loss = 0.001435
Epoch 10: Train Loss = 0.001640, Val Loss = 0.000491
Epoch 11: Train Loss = 0.001747, Val Loss = 0.000956
Epoch 12: Train Loss = 0.001777, Val Loss = 0.000292
Epoch 13: Train Loss = 0.001764, Val Loss = 0.000317
Epoch 14: Train Loss = 0.002280, Val Loss = 0.007529
Epoch 15: Train Loss = 0.002738, Val Loss = 0.008204
Epoch 16: Train Loss = 0.474815, Val Loss = 0.904568
Epoch 17: Train Loss = 3.535609, Val Loss = 0.013689
Epoch 18: Train Loss = 0.009570, Val Loss = 0.000638
Epoch 19: Train Loss = 0.001903, Val Loss = 0.002166
Epoch 20: Train Loss = 0.001786, Val Loss = 0.000576
Epoch 21: Train Loss = 0.001433, Val Loss = 0.000456
Epoch 22: Train Loss = 0.001604, Val Loss = 0.001252
Early stopping at epoch 22
Repetition 2 finished: Total Time = 757.63s, Time/sample = 0.008586s

--- Repetition 3/5 ---
Epoch 1: Train Loss = 82.784728, Val Loss = 0.018313
Epoch 2: Train Loss = 0.015936, Val Loss = 0.016788
Epoch 3: Train Loss = 0.014211, Val Loss = 0.005323
Epoch 4: Train Loss = 0.013528, Val Loss = 0.003423
Epoch 5: Train Loss = 0.012833, Val Loss = 0.001716
Epoch 6: Train Loss = 0.010293, Val Loss = 0.013695
Epoch 7: Train Loss = 0.007047, Val Loss = 0.000375
Epoch 8: Train Loss = 0.004763, Val Loss = 0.001223
Epoch 9: Train Loss = 0.003036, Val Loss = 0.000564
Epoch 10: Train Loss = 0.002567, Val Loss = 0.001095
Epoch 11: Train Loss = 0.003389, Val Loss = 0.001062
Epoch 12: Train Loss = 0.003150, Val Loss = 0.010261
Epoch 13: Train Loss = 0.003533, Val Loss = 0.004572
Epoch 14: Train Loss = 0.003701, Val Loss = 0.000575
Epoch 15: Train Loss = 0.003686, Val Loss = 0.010646
Epoch 16: Train Loss = 0.003053, Val Loss = 0.002336
Epoch 17: Train Loss = 0.003320, Val Loss = 0.000719
Early stopping at epoch 17
Repetition 3 finished: Total Time = 560.62s, Time/sample = 0.008222s

--- Repetition 4/5 ---
Epoch 1: Train Loss = 568.321721, Val Loss = 0.034085
Epoch 2: Train Loss = 0.032123, Val Loss = 0.026196
Epoch 3: Train Loss = 0.022504, Val Loss = 0.007818
Epoch 4: Train Loss = 0.012106, Val Loss = 0.003565
Epoch 5: Train Loss = 0.011794, Val Loss = 0.007668
Epoch 6: Train Loss = 0.011742, Val Loss = 0.004120
Epoch 7: Train Loss = 0.011508, Val Loss = 0.009593
Epoch 8: Train Loss = 0.011305, Val Loss = 0.014840
Epoch 9: Train Loss = 0.011750, Val Loss = 0.006568
Epoch 10: Train Loss = 0.011332, Val Loss = 0.005647
Epoch 11: Train Loss = 0.011176, Val Loss = 0.005091
Epoch 12: Train Loss = 0.011217, Val Loss = 0.007558
Epoch 13: Train Loss = 0.011107, Val Loss = 0.007119
Epoch 14: Train Loss = 0.010923, Val Loss = 0.005741
Early stopping at epoch 14
Repetition 4 finished: Total Time = 477.56s, Time/sample = 0.008504s

--- Repetition 5/5 ---
Epoch 1: Train Loss = 0.277830, Val Loss = 0.002689
Epoch 2: Train Loss = 0.001950, Val Loss = 0.000719
Epoch 3: Train Loss = 0.002246, Val Loss = 0.001024
Epoch 4: Train Loss = 0.003190, Val Loss = 0.002545
Epoch 5: Train Loss = 0.003031, Val Loss = 0.000483
Epoch 6: Train Loss = 1548.750543, Val Loss = 0.048715
Epoch 7: Train Loss = 0.016219, Val Loss = 0.001960
Epoch 8: Train Loss = 0.002101, Val Loss = 0.002782
Epoch 9: Train Loss = 0.002002, Val Loss = 0.001886
Epoch 10: Train Loss = 0.001876, Val Loss = 0.000669
Epoch 11: Train Loss = 0.001689, Val Loss = 0.000589
Epoch 12: Train Loss = 0.001692, Val Loss = 0.001628
Epoch 13: Train Loss = 0.001568, Val Loss = 0.001475
Epoch 14: Train Loss = 0.001958, Val Loss = 0.000340
Epoch 15: Train Loss = 0.001915, Val Loss = 0.000606
Epoch 16: Train Loss = 0.001646, Val Loss = 0.000747
Epoch 17: Train Loss = 0.001612, Val Loss = 0.000358
Epoch 18: Train Loss = 0.001879, Val Loss = 0.000618
Epoch 19: Train Loss = 0.001854, Val Loss = 0.000557
Epoch 20: Train Loss = 0.001879, Val Loss = 0.000467
Epoch 21: Train Loss = 0.001740, Val Loss = 0.000539
Epoch 22: Train Loss = 0.001765, Val Loss = 0.001535
Epoch 23: Train Loss = 0.001624, Val Loss = 0.001901
Epoch 24: Train Loss = 0.001708, Val Loss = 0.000855
Early stopping at epoch 24
Repetition 5 finished: Total Time = 818.83s, Time/sample = 0.008506s

====== MIONet Training Time Benchmark ======
Run 1: Total = 623.42s, Per Sample = 0.008635s
Run 2: Total = 757.63s, Per Sample = 0.008586s
Run 3: Total = 560.62s, Per Sample = 0.008222s
Run 4: Total = 477.56s, Per Sample = 0.008504s
Run 5: Total = 818.83s, Per Sample = 0.008506s

Average Total Time: 647.61s
Average Time per Sample: 0.008491s
