Using device: cuda
Train input shape: (4017, 12)
Validation input shape: (4018, 12)
Test input shape: (365, 12)
Training with window_size=90
Check the shapes of the generated sequences
-----------------------------------------
Train input shape: torch.Size([3928, 90, 12])
Train target shape: torch.Size([3928, 65341, 1])
Validation input shape: torch.Size([3929, 90, 12])
Validation target shape: torch.Size([3929, 65341, 1])
Test input shape: torch.Size([276, 90, 12])
Test target shape: torch.Size([276, 65341, 1])
-----------------------------------------
Create DataLoaders for training and validation sets
-----------------------------------------
Batch size: 16
Set the hyperparameters
-----------------------------------------
multi_branch/gru_window_90.pth
Number of epochs: 1000
Learning rate: 0.001
Patience: 10
Loss function: MSELoss()
-----------------------------------------
Epoch 1/1000, Train Loss: 52980.448130, Val Loss: 0.028025
Epoch 2/1000, Train Loss: 0.015648, Val Loss: 0.013659
Epoch 3/1000, Train Loss: 0.014446, Val Loss: 0.013331
Epoch 4/1000, Train Loss: 0.013964, Val Loss: 0.012981
Epoch 5/1000, Train Loss: 0.013425, Val Loss: 0.012505
Epoch 6/1000, Train Loss: 0.012826, Val Loss: 0.012128
Epoch 7/1000, Train Loss: 0.012214, Val Loss: 0.011562
Epoch 8/1000, Train Loss: 0.011639, Val Loss: 0.011034
Epoch 9/1000, Train Loss: 0.010942, Val Loss: 0.010505
Epoch 10/1000, Train Loss: 0.010037, Val Loss: 0.009957
Epoch 11/1000, Train Loss: 0.009660, Val Loss: 0.009337
Epoch 12/1000, Train Loss: 0.009042, Val Loss: 0.008711
Epoch 13/1000, Train Loss: 0.009178, Val Loss: 0.007762
Epoch 14/1000, Train Loss: 0.008086, Val Loss: 0.007316
Epoch 15/1000, Train Loss: 0.007214, Val Loss: 0.006305
Epoch 16/1000, Train Loss: 0.003356, Val Loss: 0.001042
Epoch 17/1000, Train Loss: 0.001630, Val Loss: 0.000626
Epoch 18/1000, Train Loss: 0.001351, Val Loss: 0.000534
Epoch 19/1000, Train Loss: 0.001309, Val Loss: 0.000619
Epoch 20/1000, Train Loss: 0.001267, Val Loss: 0.000469
Epoch 21/1000, Train Loss: 0.001183, Val Loss: 0.000709
Epoch 22/1000, Train Loss: 0.001145, Val Loss: 0.000585
Epoch 23/1000, Train Loss: 0.001090, Val Loss: 0.000428
Epoch 24/1000, Train Loss: 0.001062, Val Loss: 0.000470
Epoch 25/1000, Train Loss: 0.001039, Val Loss: 0.000885
Epoch 26/1000, Train Loss: 0.001032, Val Loss: 0.000517
Epoch 27/1000, Train Loss: 0.001002, Val Loss: 0.000642
Epoch 28/1000, Train Loss: 0.001011, Val Loss: 0.000584
Epoch 29/1000, Train Loss: 0.000970, Val Loss: 0.000815
Epoch 30/1000, Train Loss: 0.000970, Val Loss: 0.000853
Epoch 31/1000, Train Loss: 0.000951, Val Loss: 0.000466
Epoch 32/1000, Train Loss: 0.000907, Val Loss: 0.000863
Epoch 33/1000, Train Loss: 0.000915, Val Loss: 0.000892
Early stopping
Training completed
All predictions shape before reshape: (276, 65341, 1)
All targets shape before reshape: (276, 65341, 1)
All predictions shape after reshape: (276, 65341)
All targets shape after reshape: (276, 65341)
Results saved to multi_branch/array/gru_window_90_results.npy
Final Model Evaluation on Test Set:
RMSE: 0.0004, MAE: 0.0004, RÂ²: 0.9788, L2 Error: 0.1005
(0.00039319234, 0.00037328407, 0.9788008871542263, 0.10050738)
