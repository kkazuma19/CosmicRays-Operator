Using device: cuda
Train input shape: (4017, 12)
Validation input shape: (4018, 12)
Test input shape: (365, 12)
Training with window_size=30
Check the shapes of the generated sequences
-----------------------------------------
Train input shape: torch.Size([3988, 30, 12])
Train target shape: torch.Size([3988, 65341, 1])
Validation input shape: torch.Size([3989, 30, 12])
Validation target shape: torch.Size([3989, 65341, 1])
Test input shape: torch.Size([336, 30, 12])
Test target shape: torch.Size([336, 65341, 1])
-----------------------------------------
Create DataLoaders for training and validation sets
-----------------------------------------
Batch size: 16
Set the hyperparameters
-----------------------------------------
multi_branch/gru_window_30.pth
Number of epochs: 1000
Learning rate: 0.001
Patience: 10
Loss function: MSELoss()
-----------------------------------------

--- Repetition 1/5 ---
Epoch 1: Train Loss = 1200.120132, Val Loss = 0.002832
Epoch 2: Train Loss = 0.002680, Val Loss = 0.001656
Epoch 3: Train Loss = 0.002699, Val Loss = 0.004789
Epoch 4: Train Loss = 0.002780, Val Loss = 0.006037
Epoch 5: Train Loss = 0.002469, Val Loss = 0.000743
Epoch 6: Train Loss = 0.002773, Val Loss = 0.004120
Epoch 7: Train Loss = 0.003403, Val Loss = 0.003482
Epoch 8: Train Loss = 0.003790, Val Loss = 0.009365
Epoch 9: Train Loss = 0.003190, Val Loss = 0.002940
Epoch 10: Train Loss = 0.002670, Val Loss = 0.002571
Epoch 11: Train Loss = 0.003092, Val Loss = 0.000414
Epoch 12: Train Loss = 0.003916, Val Loss = 0.001985
Epoch 13: Train Loss = 0.003975, Val Loss = 0.013299
Epoch 14: Train Loss = 0.003492, Val Loss = 0.000541
Epoch 15: Train Loss = 0.004295, Val Loss = 0.000501
Epoch 16: Train Loss = 0.002896, Val Loss = 0.000678
Epoch 17: Train Loss = 0.002898, Val Loss = 0.000419
Epoch 18: Train Loss = 0.002258, Val Loss = 0.001098
Epoch 19: Train Loss = 0.004898, Val Loss = 0.001715
Epoch 20: Train Loss = 0.003313, Val Loss = 0.001369
Epoch 21: Train Loss = 0.009686, Val Loss = 0.002709
Early stopping at epoch 21
Repetition 1 finished: Total Time = 711.80s, Time/sample = 0.008499s

--- Repetition 2/5 ---
Epoch 1: Train Loss = 51268.445731, Val Loss = 0.001297
Epoch 2: Train Loss = 0.002642, Val Loss = 0.001050
Epoch 3: Train Loss = 0.002144, Val Loss = 0.001422
Epoch 4: Train Loss = 0.002298, Val Loss = 0.001119
Epoch 5: Train Loss = 0.002609, Val Loss = 0.000676
Epoch 6: Train Loss = 0.002641, Val Loss = 0.002079
Epoch 7: Train Loss = 0.002498, Val Loss = 0.004048
Epoch 8: Train Loss = 0.003408, Val Loss = 0.001692
Epoch 9: Train Loss = 0.003365, Val Loss = 0.002080
Epoch 10: Train Loss = 0.002960, Val Loss = 0.000749
Epoch 11: Train Loss = 0.004196, Val Loss = 0.000679
Epoch 12: Train Loss = 0.003315, Val Loss = 0.000742
Epoch 13: Train Loss = 0.002642, Val Loss = 0.001401
Epoch 14: Train Loss = 0.003388, Val Loss = 0.000767
Epoch 15: Train Loss = 0.003294, Val Loss = 0.000593
Epoch 16: Train Loss = 0.004620, Val Loss = 0.000640
Epoch 17: Train Loss = 0.003625, Val Loss = 0.001027
Epoch 18: Train Loss = 0.002723, Val Loss = 0.002465
Epoch 19: Train Loss = 0.002852, Val Loss = 0.001106
Epoch 20: Train Loss = 0.004072, Val Loss = 0.012723
Epoch 21: Train Loss = 0.003410, Val Loss = 0.004063
Epoch 22: Train Loss = 0.002824, Val Loss = 0.001746
Epoch 23: Train Loss = 0.463004, Val Loss = 0.834381
Epoch 24: Train Loss = 9.983746, Val Loss = 0.012745
Epoch 25: Train Loss = 0.017393, Val Loss = 0.006499
Early stopping at epoch 25
Repetition 2 finished: Total Time = 855.97s, Time/sample = 0.008585s

--- Repetition 3/5 ---
Epoch 1: Train Loss = 1582.929014, Val Loss = 0.007525
Epoch 2: Train Loss = 0.002890, Val Loss = 0.002035
Epoch 3: Train Loss = 0.002799, Val Loss = 0.000757
Epoch 4: Train Loss = 0.002779, Val Loss = 0.001152
Epoch 5: Train Loss = 0.002911, Val Loss = 0.003215
Epoch 6: Train Loss = 0.002866, Val Loss = 0.000437
Epoch 7: Train Loss = 14.144725, Val Loss = 3.768138
Epoch 8: Train Loss = 0.556444, Val Loss = 0.006746
Epoch 9: Train Loss = 0.005586, Val Loss = 0.002905
Epoch 10: Train Loss = 0.003736, Val Loss = 0.002071
Epoch 11: Train Loss = 0.002829, Val Loss = 0.003973
Epoch 12: Train Loss = 0.002489, Val Loss = 0.001066
Epoch 13: Train Loss = 0.002239, Val Loss = 0.001030
Epoch 14: Train Loss = 0.002065, Val Loss = 0.000999
Epoch 15: Train Loss = 0.002024, Val Loss = 0.001381
Epoch 16: Train Loss = 0.002067, Val Loss = 0.001465
Early stopping at epoch 16
Repetition 3 finished: Total Time = 559.38s, Time/sample = 0.008767s

--- Repetition 4/5 ---
Epoch 1: Train Loss = 53.929429, Val Loss = 0.005794
Epoch 2: Train Loss = 0.003075, Val Loss = 0.001165
Epoch 3: Train Loss = 0.002050, Val Loss = 0.000785
Epoch 4: Train Loss = 0.002092, Val Loss = 0.001156
Epoch 5: Train Loss = 0.002825, Val Loss = 0.000591
Epoch 6: Train Loss = 0.002559, Val Loss = 0.001977
Epoch 7: Train Loss = 0.002780, Val Loss = 0.000761
Epoch 8: Train Loss = 0.003660, Val Loss = 0.000609
Epoch 9: Train Loss = 0.002877, Val Loss = 0.001073
Epoch 10: Train Loss = 0.002267, Val Loss = 0.002645
Epoch 11: Train Loss = 0.002406, Val Loss = 0.000950
Epoch 12: Train Loss = 0.002090, Val Loss = 0.001900
Epoch 13: Train Loss = 0.002657, Val Loss = 0.002589
Epoch 14: Train Loss = 0.002438, Val Loss = 0.001039
Epoch 15: Train Loss = 0.002500, Val Loss = 0.004342
Early stopping at epoch 15
Repetition 4 finished: Total Time = 523.40s, Time/sample = 0.008750s

--- Repetition 5/5 ---
Epoch 1: Train Loss = 38830.487783, Val Loss = 0.000971
Epoch 2: Train Loss = 0.002269, Val Loss = 0.000612
Epoch 3: Train Loss = 0.003524, Val Loss = 0.001449
Epoch 4: Train Loss = 0.003033, Val Loss = 0.001476
Epoch 5: Train Loss = 0.003315, Val Loss = 0.000492
Epoch 6: Train Loss = 0.003127, Val Loss = 0.000539
Epoch 7: Train Loss = 0.004018, Val Loss = 0.000490
Epoch 8: Train Loss = 0.003813, Val Loss = 0.004732
Epoch 9: Train Loss = 0.003315, Val Loss = 0.003624
Epoch 10: Train Loss = 0.002863, Val Loss = 0.000842
Epoch 11: Train Loss = 0.002852, Val Loss = 0.006270
Epoch 12: Train Loss = 0.003482, Val Loss = 0.007907
Epoch 13: Train Loss = 0.003273, Val Loss = 0.006583
Epoch 14: Train Loss = 0.003987, Val Loss = 0.002089
Epoch 15: Train Loss = 0.003291, Val Loss = 0.000807
Epoch 16: Train Loss = 0.002841, Val Loss = 0.000569
Epoch 17: Train Loss = 0.003569, Val Loss = 0.001666
Early stopping at epoch 17
Repetition 5 finished: Total Time = 583.95s, Time/sample = 0.008613s

====== MIONet Training Time Benchmark ======
Run 1: Total = 711.80s, Per Sample = 0.008499s
Run 2: Total = 855.97s, Per Sample = 0.008585s
Run 3: Total = 559.38s, Per Sample = 0.008767s
Run 4: Total = 523.40s, Per Sample = 0.008750s
Run 5: Total = 583.95s, Per Sample = 0.008613s

Average Total Time: 646.90s
Average Time per Sample: 0.008643s