Using device: cuda
Train input shape: (4017, 12)
Validation input shape: (4018, 12)
Test input shape: (365, 12)
Training with window_size=90
Check the shapes of the generated sequences
-----------------------------------------
Train input shape: torch.Size([3928, 90, 12])
Train target shape: torch.Size([3928, 65341, 1])
Validation input shape: torch.Size([3929, 90, 12])
Validation target shape: torch.Size([3929, 65341, 1])
Test input shape: torch.Size([276, 90, 12])
Test target shape: torch.Size([276, 65341, 1])
-----------------------------------------
Create DataLoaders for training and validation sets
-----------------------------------------
Batch size: 16
Set the hyperparameters
-----------------------------------------
multi_branch/lstm_window_90.pth
Number of epochs: 1000
Learning rate: 0.001
Patience: 10
Loss function: MSELoss()
-----------------------------------------

--- Repetition 1/5 ---
Epoch 1: Train Loss = 795.371013, Val Loss = 0.001892
Epoch 2: Train Loss = 0.004920, Val Loss = 0.000886
Epoch 3: Train Loss = 0.005256, Val Loss = 0.000675
Epoch 4: Train Loss = 0.004876, Val Loss = 0.007499
Epoch 5: Train Loss = 0.004061, Val Loss = 0.000647
Epoch 6: Train Loss = 0.003294, Val Loss = 0.001956
Epoch 7: Train Loss = 0.003233, Val Loss = 0.002353
Epoch 8: Train Loss = 0.002370, Val Loss = 0.003328
Epoch 9: Train Loss = 0.002609, Val Loss = 0.001217
Epoch 10: Train Loss = 0.002463, Val Loss = 0.000400
Epoch 11: Train Loss = 0.002226, Val Loss = 0.000411
Epoch 12: Train Loss = 0.002568, Val Loss = 0.000954
Epoch 13: Train Loss = 0.001986, Val Loss = 0.000483
Epoch 14: Train Loss = 0.001850, Val Loss = 0.000632
Epoch 15: Train Loss = 0.001903, Val Loss = 0.000962
Epoch 16: Train Loss = 0.001749, Val Loss = 0.001071
Epoch 17: Train Loss = 0.001912, Val Loss = 0.000612
Epoch 18: Train Loss = 0.001877, Val Loss = 0.000544
Epoch 19: Train Loss = 0.001696, Val Loss = 0.001934
Epoch 20: Train Loss = 0.001670, Val Loss = 0.001048
Early stopping at epoch 20
Repetition 1 finished: Total Time = 1098.59s, Time/sample = 0.013984s

--- Repetition 2/5 ---
Epoch 1: Train Loss = 0.705212, Val Loss = 0.001933
Epoch 2: Train Loss = 0.002501, Val Loss = 0.000968
Epoch 3: Train Loss = 0.001972, Val Loss = 0.001888
Epoch 4: Train Loss = 0.001900, Val Loss = 0.000579
Epoch 5: Train Loss = 0.001919, Val Loss = 0.000574
Epoch 6: Train Loss = 0.002494, Val Loss = 0.001389
Epoch 7: Train Loss = 0.002258, Val Loss = 0.001321
Epoch 8: Train Loss = 0.002047, Val Loss = 0.000748
Epoch 9: Train Loss = 0.002111, Val Loss = 0.008421
Epoch 10: Train Loss = 0.004055, Val Loss = 0.006796
Epoch 11: Train Loss = 0.003626, Val Loss = 0.002495
Epoch 12: Train Loss = 0.005514, Val Loss = 0.000793
Epoch 13: Train Loss = 0.005620, Val Loss = 0.004236
Epoch 14: Train Loss = 0.004838, Val Loss = 0.001631
Epoch 15: Train Loss = 860277.688135, Val Loss = 0.099672
Early stopping at epoch 15
Repetition 2 finished: Total Time = 808.72s, Time/sample = 0.013726s

--- Repetition 3/5 ---
Epoch 1: Train Loss = 0.172162, Val Loss = 0.001212
Epoch 2: Train Loss = 0.003158, Val Loss = 0.004999
Epoch 3: Train Loss = 0.003058, Val Loss = 0.018926
Epoch 4: Train Loss = 0.004647, Val Loss = 0.024335
Epoch 5: Train Loss = 0.006187, Val Loss = 0.000313
Epoch 6: Train Loss = 758290.600656, Val Loss = 2.162974
Epoch 7: Train Loss = 0.167980, Val Loss = 0.005020
Epoch 8: Train Loss = 0.004267, Val Loss = 0.001408
Epoch 9: Train Loss = 0.003280, Val Loss = 0.000826
Epoch 10: Train Loss = 0.002722, Val Loss = 0.001839
Epoch 11: Train Loss = 0.002961, Val Loss = 0.000971
Epoch 12: Train Loss = 0.002559, Val Loss = 0.000699
Epoch 13: Train Loss = 0.003406, Val Loss = 0.015449
Epoch 14: Train Loss = 0.008894, Val Loss = 0.002038
Epoch 15: Train Loss = 0.002746, Val Loss = 0.000846
Early stopping at epoch 15
Repetition 3 finished: Total Time = 811.06s, Time/sample = 0.013765s

--- Repetition 4/5 ---
Epoch 1: Train Loss = 5079.785934, Val Loss = 0.009753
Epoch 2: Train Loss = 0.008737, Val Loss = 0.009308
Epoch 3: Train Loss = 0.007545, Val Loss = 0.006570
Epoch 4: Train Loss = 0.006775, Val Loss = 0.005569
Epoch 5: Train Loss = 0.006162, Val Loss = 0.004517
Epoch 6: Train Loss = 0.005770, Val Loss = 0.004300
Epoch 7: Train Loss = 0.005396, Val Loss = 0.004111
Epoch 8: Train Loss = 0.004861, Val Loss = 0.003734
Epoch 9: Train Loss = 0.004548, Val Loss = 0.006135
Epoch 10: Train Loss = 0.004289, Val Loss = 0.002715
Epoch 11: Train Loss = 0.003912, Val Loss = 0.002924
Epoch 12: Train Loss = 0.003629, Val Loss = 0.003007
Epoch 13: Train Loss = 0.003489, Val Loss = 0.002162
Epoch 14: Train Loss = 0.003070, Val Loss = 0.002474
Epoch 15: Train Loss = 0.002931, Val Loss = 0.003471
Epoch 16: Train Loss = 0.002816, Val Loss = 0.002177
Epoch 17: Train Loss = 0.002667, Val Loss = 0.001923
Epoch 18: Train Loss = 0.002806, Val Loss = 0.002051
Epoch 19: Train Loss = 0.002508, Val Loss = 0.001432
Epoch 20: Train Loss = 0.002586, Val Loss = 0.002441
Epoch 21: Train Loss = 0.130640, Val Loss = 0.049750
Epoch 22: Train Loss = 0.023594, Val Loss = 0.003546
Epoch 23: Train Loss = 0.004457, Val Loss = 0.002947
Epoch 24: Train Loss = 0.004069, Val Loss = 0.002740
Epoch 25: Train Loss = 0.003832, Val Loss = 0.002686
Epoch 26: Train Loss = 0.003670, Val Loss = 0.002431
Epoch 27: Train Loss = 0.003378, Val Loss = 0.002168
Epoch 28: Train Loss = 0.003262, Val Loss = 0.002349
Epoch 29: Train Loss = 0.003162, Val Loss = 0.002077
Early stopping at epoch 29
Repetition 4 finished: Total Time = 1360.78s, Time/sample = 0.011946s

--- Repetition 5/5 ---
Epoch 1: Train Loss = 805.397982, Val Loss = 0.012613
Epoch 2: Train Loss = 0.011842, Val Loss = 0.004976
Epoch 3: Train Loss = 0.009902, Val Loss = 0.002454
Epoch 4: Train Loss = 0.010202, Val Loss = 0.000949
Epoch 5: Train Loss = 0.007673, Val Loss = 0.000728
Epoch 6: Train Loss = 0.006912, Val Loss = 0.000870
Epoch 7: Train Loss = 0.007009, Val Loss = 0.003149
Epoch 8: Train Loss = 0.004173, Val Loss = 0.003327
Epoch 9: Train Loss = 0.004433, Val Loss = 0.003403
Epoch 10: Train Loss = 0.004845, Val Loss = 0.000905
Epoch 11: Train Loss = 0.003874, Val Loss = 0.001399
Epoch 12: Train Loss = 0.002893, Val Loss = 0.000943
Epoch 13: Train Loss = 0.004755, Val Loss = 0.004341
Epoch 14: Train Loss = 0.003725, Val Loss = 0.014780
Epoch 15: Train Loss = 0.003017, Val Loss = 0.001254
Early stopping at epoch 15
Repetition 5 finished: Total Time = 459.56s, Time/sample = 0.007800s

====== MIONet Training Time Benchmark ======
Run 1: Total = 1098.59s, Per Sample = 0.013984s
Run 2: Total = 808.72s, Per Sample = 0.013726s
Run 3: Total = 811.06s, Per Sample = 0.013765s
Run 4: Total = 1360.78s, Per Sample = 0.011946s
Run 5: Total = 459.56s, Per Sample = 0.007800s

Average Total Time: 907.74s
Average Time per Sample: 0.012244s
